# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–∏—Ö SQL –∑–∞–ø–∏—Ç—ñ–≤

## üéØ –ú–µ—Ç–∞ —Ä–æ–±–æ—Ç–∏

–ù–∞–±—É—Ç–∏ –ø—Ä–∞–∫—Ç–∏—á–Ω–∏—Ö –Ω–∞–≤–∏—á–æ–∫ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–∏—Ö SQL –∑–∞–ø–∏—Ç—ñ–≤ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –¥–∞–Ω–∏—Ö, –æ–ø–∞–Ω—É–≤–∞—Ç–∏ —Ç–µ—Ö–Ω—ñ–∫–∏ –∑'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–≥—Ä–µ–≥–∞—Ç–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π, –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç–∞ –Ω–∞–ø–∏—Å–∞–Ω–Ω—è –ø—ñ–¥–∑–∞–ø–∏—Ç—ñ–≤ –¥–ª—è —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—è –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å —É —Ä–µ–ª—è—Ü—ñ–π–Ω–∏—Ö –±–∞–∑–∞—Ö –¥–∞–Ω–∏—Ö.

## –ó–∞–≤–¥–∞–Ω–Ω—è

### –†—ñ–≤–µ–Ω—å 1

1. –ó'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å
   - –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º INNER JOIN –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑ –∫—ñ–ª—å–∫–æ—Ö –ø–æ–≤'—è–∑–∞–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—å
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ LEFT JOIN –¥–ª—è –≤–∫–ª—é—á–µ–Ω–Ω—è –≤—Å—ñ—Ö –∑–∞–ø–∏—Å—ñ–≤ –∑ –≥–æ–ª–æ–≤–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ
   - –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç –∑ –º–Ω–æ–∂–∏–Ω–Ω–∏–º–∏ –∑'—î–¥–Ω–∞–Ω–Ω—è–º–∏ (–º—ñ–Ω—ñ–º—É–º 3 —Ç–∞–±–ª–∏—Ü—ñ)
2. –ê–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó COUNT, SUM, AVG, MIN, MAX –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤
   - –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –∑ GROUP BY –¥–ª—è –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑–∞ —Ä—ñ–∑–Ω–∏–º–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—è–º–∏
   - –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ HAVING –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –≥—Ä—É–ø –∑–∞ —É–º–æ–≤–∞–º–∏
3. –ë–∞–∑–æ–≤—ñ –ø—ñ–¥–∑–∞–ø–∏—Ç–∏
   - –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—ñ–¥–∑–∞–ø–∏—Ç —É —Ä–æ–∑–¥—ñ–ª—ñ WHERE –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –∑–∞–ø–∏—Å—ñ–≤
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –ø—ñ–¥–∑–∞–ø–∏—Ç —É —Ä–æ–∑–¥—ñ–ª—ñ SELECT –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –ø–æ–ª—ñ–≤
   - –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –æ–ø–µ—Ä–∞—Ç–æ—Ä—ñ–≤ IN —Ç–∞ EXISTS

### –†—ñ–≤–µ–Ω—å 2

4. –°–∫–ª–∞–¥–Ω—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞ –∞–Ω–∞–ª—ñ–∑
   - –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç –∑ RIGHT JOIN —Ç–∞ FULL OUTER JOIN
   - –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Å–∞–º–æ–∑'—î–¥–Ω–∞–Ω–Ω—è (self-join) —Ç–∞–±–ª–∏—Ü—ñ
   - –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç –∑ —É–º–æ–≤–Ω–∏–º –∑'—î–¥–Ω–∞–Ω–Ω—è–º (–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ —É–º–æ–≤–∞–º–∏ –≤ ON)
5. –í—ñ–∫–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —Ç–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ ROW_NUMBER(), RANK(), DENSE_RANK() –¥–ª—è —Ä–∞–Ω–∂—É–≤–∞–Ω–Ω—è
   - –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ LAG(), LEAD() –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º–∏/–Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –∑–∞–ø–∏—Å–∞–º–∏
   - –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ –∑ PARTITION BY –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –≤ —Ä–æ–∑—Ä—ñ–∑–∞—Ö

### –†—ñ–≤–µ–Ω—å 3

6. –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —Ç–∞ —Å–∫–ª–∞–¥–Ω–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞
   - –°—Ç–≤–æ—Ä–∏—Ç–∏ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è (materialized view) –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
   - –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π –∑–∞–ø–∏—Ç –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º CTE (Common Table Expression)
   - –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç –∑ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–º SQL –∞–±–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ—é –ø—Ä–æ—Ü–µ–¥—É—Ä–æ—é –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–æ—ó –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏


## üñ•Ô∏è –ü—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è

- supabase [supabase.com](https://supabase.com) - —Ö–º–∞—Ä–Ω–∏–π —Å–µ—Ä–≤—ñ—Å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ PostgreSQL.

## üë• –§–æ—Ä–º–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ä–æ–±–æ—Ç–∏

–§–æ—Ä–º–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ **—ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–∞**.

## üìù –ö—Ä–∏—Ç–µ—Ä—ñ—ó –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è

- —Å–µ—Ä–µ–¥–Ω—ñ–π —Ä—ñ–≤–µ–Ω—å (–æ—Ü—ñ–Ω–∫–∞ "–∑–∞–¥–æ–≤—ñ–ª—å–Ω–æ") - –≤–∏–∫–æ–Ω–∞–Ω–æ –∑–∞–≤–¥–∞–Ω–Ω—è —Ä—ñ–≤–Ω—è 1. –î–æ–ø—É—Å–∫–∞—é—Ç—å—Å—è –Ω–µ–∑–Ω–∞—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏ —É –∑–≤—ñ—Ç—ñ. –ü—ñ–¥ —á–∞—Å –∑–∞—Ö–∏—Å—Ç—É –∑–¥–æ–±—É–≤–∞—á –æ—Å–≤—ñ—Ç–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –±–∞–∑–æ–≤–µ —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π —Ç–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è;
- –¥–æ—Å—Ç–∞—Ç–Ω—ñ–π —Ä—ñ–≤–µ–Ω—å (–æ—Ü—ñ–Ω–∫–∞ "–¥–æ–±—Ä–µ") - –≤–∏–∫–æ–Ω–∞–Ω–æ –≤—Å—ñ –≤–∏–º–æ–≥–∏ —Ä—ñ–≤–Ω—è 2. –ü—ñ–¥ —á–∞—Å –∑–∞—Ö–∏—Å—Ç—É –¥–æ–ø—É—Å–∫–∞—é—Ç—å—Å—è –Ω–µ–≤–µ–ª–∏–∫—ñ –ø–æ–º–∏–ª–∫–∏ —Ç–∞ –Ω–µ–ø–æ–≤–Ω–µ —Ä–æ–∑—É–º—ñ–Ω–Ω—è –¥–µ—è–∫–∏—Ö –∞—Å–ø–µ–∫—Ç—ñ–≤ —Ä–æ–±–æ—Ç–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π;
- –≤–∏—Å–æ–∫–∏–π —Ä—ñ–≤–µ–Ω—å (–æ—Ü—ñ–Ω–∫–∞ "–≤—ñ–¥–º—ñ–Ω–Ω–æ") - –≤–∏–∫–æ–Ω–∞–Ω–æ –∑–∞–≤–¥–∞–Ω–Ω—è —Ä—ñ–≤–Ω—è 3. –ü—ñ–¥ —á–∞—Å –∑–∞—Ö–∏—Å—Ç—É –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–æ–≤–∞–Ω–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤ —Ä–æ–±–æ—Ç–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–π, –∑–¥–æ–±—É–≤–∞—á –æ—Å–≤—ñ—Ç–∏ –º–æ–∂–µ –ø–æ—è—Å–Ω–∏—Ç–∏ —Ç–∞ –æ–±“ë—Ä—É–Ω—Ç—É–≤–∞—Ç–∏ –ø—Ä–∏–π–Ω—è—Ç—ñ —Ä—ñ—à–µ–Ω–Ω—è, –ø—Ä–æ—è–≤–ª–µ–Ω–æ —Ç–≤–æ—Ä—á–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω–Ω—è.

## ‚è∞ –ü–æ–ª—ñ—Ç–∏–∫–∞ —â–æ–¥–æ –¥–µ–¥–ª–∞–π–Ω—ñ–≤

–ü—Ä–∏ –ø–æ—Ä—É—à–µ–Ω–Ω—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ —Ç–µ—Ä–º—ñ–Ω—É –∑–¥–∞—á—ñ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –º–æ–∂–ª–∏–≤–∞ –æ—Ü—ñ–Ω–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å "–¥–æ–±—Ä–µ", –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —è–∫–æ—Å—Ç—ñ –≤–∏–∫–æ–Ω–∞–Ω–æ—ó —Ä–æ–±–æ—Ç–∏. –í–∏–Ω—è—Ç–∫–∏ –º–æ–∂–ª–∏–≤—ñ –ª–∏—à–µ –∑–∞ –ø–æ–≤–∞–∂–Ω–∏—Ö –ø—Ä–∏—á–∏–Ω, –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞–ª—å–Ω–æ.

## üìö –¢–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ –≤—ñ–¥–æ–º–æ—Å—Ç—ñ

## –¢–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ –≤—ñ–¥–æ–º–æ—Å—Ç—ñ

### –ó'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å (JOIN) - –æ—Å–Ω–æ–≤–∞ —Ä–æ–±–æ—Ç–∏ –∑ —Ä–µ–ª—è—Ü—ñ–π–Ω–∏–º–∏ –±–∞–∑–∞–º–∏ –¥–∞–Ω–∏—Ö

–£—è–≤—ñ—Ç—å, —â–æ —É –≤–∞—Å —î –¥–≤—ñ –∞–¥—Ä–µ—Å–Ω—ñ –∫–Ω–∏–≥–∏: –æ–¥–Ω–∞ –∑ —ñ–º–µ–Ω–∞–º–∏ —Ç–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞–º–∏, –¥—Ä—É–≥–∞ –∑ —ñ–º–µ–Ω–∞–º–∏ —Ç–∞ –∞–¥—Ä–µ—Å–∞–º–∏. –©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ª—é–¥–∏–Ω—É (—ñ–º'—è, —Ç–µ–ª–µ—Ñ–æ–Ω, –∞–¥—Ä–µ—Å–∞), –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –∑–∞–ø–∏—Å–∏ –≤ –æ–±–æ—Ö –∫–Ω–∏–≥–∞—Ö –∑–∞ —ñ–º'—è–º. –°–∞–º–µ —Ü–µ —Ä–æ–±–∏—Ç—å –æ–ø–µ—Ä–∞—Ü—ñ—è JOIN —É –±–∞–∑–∞—Ö –¥–∞–Ω–∏—Ö.

#### –ß–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è?

–†–µ–ª—è—Ü—ñ–π–Ω—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –ø–æ–±—É–¥–æ–≤–∞–Ω—ñ –∑–∞ –ø—Ä–∏–Ω—Ü–∏–ø–æ–º –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è —Ä–æ–∑–±–∏—Ç–∞ –Ω–∞ –æ–∫—Ä–µ–º—ñ —Ç–∞–±–ª–∏—Ü—ñ, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –¥—É–±–ª—é–≤–∞–Ω–Ω—è. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –≤ —Ç–∞–±–ª–∏—Ü—ñ "–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è" –ø–æ–≤—Ç–æ—Ä—é–≤–∞—Ç–∏ –Ω–∞–∑–≤—É —Ç–æ–≤–∞—Ä—É –≤ –∫–æ–∂–Ω–æ–º—É —Ä—è–¥–∫—É, –º–∏ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –ª–∏—à–µ ID —Ç–æ–≤–∞—Ä—É, –∞ –ø–æ–≤–Ω—É –Ω–∞–∑–≤—É —Ç—Ä–∏–º–∞—î–º–æ –≤ –æ–∫—Ä–µ–º—ñ–π —Ç–∞–±–ª–∏—Ü—ñ "–¢–æ–≤–∞—Ä–∏".

```
–ü–æ–≥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–Ω–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∞):
ORDERS:
order_id | customer_name | product_name      | price
1        | Petrov        | iPhone 15         | 29999
2        | Petrov        | iPhone 15         | 29999  ‚Üê –î—É–±–ª—é–≤–∞–Ω–Ω—è!
3        | Ivanenko      | Samsung Galaxy    | 27999

–•–æ—Ä–æ—à–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∞):
ORDERS:              PRODUCTS:
order_id | product_id   product_id | product_name      | price
1        | 101          101        | iPhone 15         | 29999
2        | 101          102        | Samsung Galaxy    | 27999
3        | 102
```

#### –°–∏–Ω—Ç–∞–∫—Å–∏—Å –∑'—î–¥–Ω–∞–Ω—å

**–ó–∞–≥–∞–ª—å–Ω–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å:**

```sql
SELECT —Å—Ç–æ–≤–ø—Ü—ñ
FROM —Ç–∞–±–ª–∏—Ü—è1 [–ø—Å–µ–≤–¥–æ–Ω—ñ–º1]
[INNER|LEFT|RIGHT|FULL OUTER] JOIN —Ç–∞–±–ª–∏—Ü—è2 [–ø—Å–µ–≤–¥–æ–Ω—ñ–º2]
    ON —É–º–æ–≤–∞_–∑'—î–¥–Ω–∞–Ω–Ω—è
[WHERE —É–º–æ–≤–∏_—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó]
[ORDER BY —Å—Ç–æ–≤–ø—Ü—ñ_—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è];
```

**–ö–ª—é—á–æ–≤—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É:**

- `ON` - –æ–±–æ–≤'—è–∑–∫–æ–≤–∞ —É–º–æ–≤–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è (–∑–∞–º—ñ—Å—Ç—å —Å—Ç–∞—Ä–æ–≥–æ WHERE)
- –ü—Å–µ–≤–¥–æ–Ω—ñ–º–∏ —Ç–∞–±–ª–∏—Ü—å —Ä–æ–±–ª—è—Ç—å –∫–æ–¥ –∫–æ—Ä–æ—Ç—à–∏–º —ñ —á–∏—Ç–∞–±–µ–ª—å–Ω—ñ—à–∏–º
- –£–º–æ–≤–∞ –∑–∞–∑–≤–∏—á–∞–π –ø–æ—Ä—ñ–≤–Ω—é—î –ø–µ—Ä–≤–∏–Ω–Ω–∏–π –∫–ª—é—á –∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º –∫–ª—é—á–µ–º

#### –¢–∏–ø–∏ –∑'—î–¥–Ω–∞–Ω—å –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º–∏ –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º–∏

**INNER JOIN - "–¢—ñ–ª—å–∫–∏ —Å–ø—ñ–ª—å–Ω–µ"**

–ü–æ–≤–µ—Ä—Ç–∞—î –∑–∞–ø–∏—Å–∏, —è–∫—ñ —î –≤ –æ–±–æ—Ö —Ç–∞–±–ª–∏—Ü—è—Ö. –Ø–∫ –ø–µ—Ä–µ—Ç–∏–Ω –¥–≤–æ—Ö –∫—ñ–ª —É –¥—ñ–∞–≥—Ä–∞–º—ñ –í–µ–Ω–Ω–∞.

```sql
-- –ü–æ–≤–Ω–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
SELECT p.product_name, c.category_name, p.unit_price
FROM products p
INNER JOIN categories c ON p.category_id = c.category_id;

-- –°–∫–æ—Ä–æ—á–µ–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç (INNER –º–æ–∂–Ω–∞ –æ–ø—É—Å—Ç–∏—Ç–∏)
SELECT p.product_name, c.category_name, p.unit_price
FROM products p
JOIN categories c ON p.category_id = c.category_id;
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ INNER JOIN:**

- –í–∏–∫–ª—é—á–∞—î NULL –∑–Ω–∞—á–µ–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ
- –ù–∞–π—à–≤–∏–¥—à–∏–π —Ç–∏–ø –∑'—î–¥–Ω–∞–Ω–Ω—è
- –Ø–∫—â–æ –≤ –æ–¥–Ω—ñ–π –∑ —Ç–∞–±–ª–∏—Ü—å –Ω–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ, —Ä—è–¥–æ–∫ –Ω–µ –ø–æ—Ç—Ä–∞–ø–ª—è—î –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**LEFT JOIN (LEFT OUTER JOIN) - "–£—Å–µ –∑ –ª—ñ–≤–æ—ó + –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –∑ –ø—Ä–∞–≤–æ—ó"**

```sql
-- –ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤, –Ω–∞–≤—ñ—Ç—å —Ç–∏—Ö, —Ö—Ç–æ –Ω–µ —Ä–æ–±–∏–≤ –∑–∞–º–æ–≤–ª–µ–Ω—å
SELECT c.contact_name, c.customer_type,
       COUNT(o.order_id) as order_count,
       COALESCE(SUM(o.freight), 0) as total_freight
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.contact_name, c.customer_type;
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ LEFT JOIN:**

- –ó–∞–≤–∂–¥–∏ –≤–∫–ª—é—á–∞—î –í–°–Ü —Ä—è–¥–∫–∏ –∑ –ª—ñ–≤–æ—ó (–ø–µ—Ä—à–æ—ó) —Ç–∞–±–ª–∏—Ü—ñ
- –î–ª—è —Ä—è–¥–∫—ñ–≤ –±–µ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç–µ–π –≤ –ø—Ä–∞–≤—ñ–π —Ç–∞–±–ª–∏—Ü—ñ –∑–∞–ø–æ–≤–Ω—é—î NULL
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `COALESCE()` –∞–±–æ `ISNULL()` –¥–ª—è –æ–±—Ä–æ–±–∫–∏ NULL –∑–Ω–∞—á–µ–Ω—å
- –ö–æ—Ä–∏—Å–Ω–∏–π –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è "—Å–∏—Ä—ñ—Ç" - –∑–∞–ø–∏—Å—ñ–≤ –±–µ–∑ –∑–≤'—è–∑–∫—ñ–≤

**RIGHT JOIN - —Ä—ñ–¥–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è**

```sql
-- –ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤ –Ω–∏—Ö –Ω–µ–º–∞—î —Ç–æ–≤–∞—Ä—ñ–≤
SELECT c.category_name, COUNT(p.product_id) as product_count
FROM products p
RIGHT JOIN categories c ON p.category_id = c.category_id
GROUP BY c.category_id, c.category_name;
```

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** RIGHT JOIN –∑–∞–∑–≤–∏—á–∞–π –ø–µ—Ä–µ–ø–∏—Å—É—é—Ç—å —è–∫ LEFT JOIN –¥–ª—è –∫—Ä–∞—â–æ—ó —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ.

**FULL OUTER JOIN - —Ä—ñ–¥–∫–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω**

```sql
-- –ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ç–∞ –≤—Å—ñ —Ç–æ–≤–∞—Ä–∏
SELECT c.category_name, p.product_name
FROM categories c
FULL OUTER JOIN products p ON c.category_id = p.category_id;
```

#### –ú–Ω–æ–∂–∏–Ω–Ω—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è - –ø–æ–µ—Ç–∞–ø–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥

```sql
-- –ö—Ä–æ–∫ –∑–∞ –∫—Ä–æ–∫–æ–º: –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è ‚Üí —Ç–æ–≤–∞—Ä–∏ ‚Üí –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó ‚Üí –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∏
SELECT
    o.order_id,
    o.order_date,
    p.product_name,
    c.category_name,
    s.company_name as supplier,
    oi.quantity,
    oi.unit_price
FROM orders o                                          -- –ü–æ—á–∞—Ç–∫–æ–≤–∞ —Ç–∞–±–ª–∏—Ü—è
    JOIN order_items oi ON o.order_id = oi.order_id  -- –ö—Ä–æ–∫ 1: –¥–µ—Ç–∞–ª—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
    JOIN products p ON oi.product_id = p.product_id   -- –ö—Ä–æ–∫ 2: —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ç–æ–≤–∞—Ä
    JOIN categories c ON p.category_id = c.category_id -- –ö—Ä–æ–∫ 3: –∫–∞—Ç–µ–≥–æ—Ä—ñ—è
    JOIN suppliers s ON p.supplier_id = s.supplier_id  -- –ö—Ä–æ–∫ 4: –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫
WHERE o.order_date >= '2024-01-01';
```

**–ü–æ—Ä—è–¥–æ–∫ –∑'—î–¥–Ω–∞–Ω—å –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ:**

1. –ü–æ—á–∏–Ω–∞–π—Ç–µ –∑ —Ç–∞–±–ª–∏—Ü—ñ –∑ –Ω–∞–π–º–µ–Ω—à–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Ä—è–¥–∫—ñ–≤ –ø—ñ—Å–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó
2. –ó'—î–¥–Ω—É–π—Ç–µ —Å–ø–æ—á–∞—Ç–∫—É —Ç–∞–±–ª–∏—Ü—ñ –∑ –Ω–∞–π–∫—Ä–∞—â–æ—é —Å–µ–ª–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é
3. WHERE —É–º–æ–≤–∏ –∑–∞—Å—Ç–æ—Å–æ–≤—É–π—Ç–µ —è–∫–æ–º–æ–≥–∞ —Ä–∞–Ω—ñ—à–µ

### –ê–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó - –ø—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —Ç–∞ –∞–Ω–∞–ª—ñ–∑

–ê–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–æ–∑–≤–æ–ª—è—é—Ç—å "–∑–≥–æ—Ä–Ω—É—Ç–∏" –±–∞–≥–∞—Ç–æ —Ä—è–¥–∫—ñ–≤ –≤ –æ–¥–Ω–µ –ø—ñ–¥—Å—É–º–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è. –¶–µ —è–∫ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–ª—è —Ü—ñ–ª–æ—ó –∫–æ–ª–æ–Ω–∫–∏ –¥–∞–Ω–∏—Ö.

#### –û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º–∏ –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º–∏

**COUNT() - –†–∞—Ö—É—î–º–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å**

```sql
-- –¢—Ä–∏ —Ä—ñ–∑–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ COUNT
SELECT
    COUNT(*) as total_rows,           -- –í—Å—ñ —Ä—è–¥–∫–∏, –≤–∫–ª—é—á–∞—é—á–∏ NULL
    COUNT(product_name) as named_products,  -- –¢—ñ–ª—å–∫–∏ –Ω–µ-NULL –Ω–∞–∑–≤–∏
    COUNT(DISTINCT category_id) as unique_categories -- –£–Ω—ñ–∫–∞–ª—å–Ω—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
FROM products;
```

**–í–∞–∂–ª–∏–≤—ñ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ COUNT:**

- `COUNT(*)` —Ä–∞—Ö—É—î –í–°–Ü —Ä—è–¥–∫–∏, –Ω–∞–≤—ñ—Ç—å –∑ NULL
- `COUNT(column)` —ñ–≥–Ω–æ—Ä—É—î NULL –∑–Ω–∞—á–µ–Ω–Ω—è
- `COUNT(DISTINCT column)` —Ä–∞—Ö—É—î —Ç—ñ–ª—å–∫–∏ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ –Ω–µ-NULL –∑–Ω–∞—á–µ–Ω–Ω—è

**SUM() - –°—É–º—É–≤–∞–Ω–Ω—è –∑ –Ω—é–∞–Ω—Å–∞–º–∏**

```sql
-- –û–±–µ—Ä–µ–∂–Ω–æ –∑ NULL!
SELECT
    SUM(unit_price) as total_price,                    -- NULL —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
    SUM(unit_price * units_in_stock) as total_value,   -- NULL –¥–∞—î NULL
    SUM(COALESCE(unit_price, 0) * COALESCE(units_in_stock, 0)) as safe_total
FROM products;
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ SUM:**

- –ü–æ–≤–µ—Ä—Ç–∞—î NULL, —è–∫—â–æ –í–°–Ü –∑–Ω–∞—á–µ–Ω–Ω—è NULL
- –Ü–≥–Ω–æ—Ä—É—î NULL, –∞–ª–µ —è–∫—â–æ –≤ –≤–∏—Ä–∞–∑—ñ —î NULL, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ NULL
- –ü—Ä–∞—Ü—é—î —Ç—ñ–ª—å–∫–∏ –∑ —á–∏—Å–ª–æ–≤–∏–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–∏—Ö

**AVG() - –°–µ—Ä–µ–¥–Ω—î –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–µ**

```sql
-- –†—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ AVG —Ç–∞ —Ä—É—á–Ω–∏–º —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–º
SELECT
    AVG(unit_price) as avg_by_function,
    SUM(unit_price) / COUNT(unit_price) as manual_avg,  -- –¢–µ —Å–∞–º–µ
    SUM(unit_price) / COUNT(*) as avg_with_nulls        -- –Ü–Ω—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!
FROM products;
```

**MIN() —Ç–∞ MAX() - –Ω–µ —Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Å–µ–ª**

```sql
-- –ü—Ä–∞—Ü—é—é—Ç—å –∑ —Ä—ñ–∑–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–∏—Ö
SELECT
    MIN(unit_price) as cheapest,
    MAX(unit_price) as most_expensive,
    MIN(product_name) as first_alphabetically,  -- 'A...'
    MAX(order_date) as latest_order             -- –ù–∞–π—Å–≤—ñ–∂—ñ—à–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
FROM products, orders;
```

#### GROUP BY - –î–µ—Ç–∞–ª—å–Ω–∞ —Å–µ–º–∞–Ω—Ç–∏–∫–∞

GROUP BY —Ä–æ–∑–±–∏–≤–∞—î –¥–∞–Ω—ñ –Ω–∞ –≥—Ä—É–ø–∏ —Ç–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –∞–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–æ –∫–æ–∂–Ω–æ—ó –≥—Ä—É–ø–∏ –æ–∫—Ä–µ–º–æ.

**–Ø–∫ –ø—Ä–∞—Ü—é—î GROUP BY –ø–æ–µ—Ç–∞–ø–Ω–æ:**

1. **–ï—Ç–∞–ø —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è:** –ß–∏—Ç–∞—î –≤—Å—ñ —Ä—è–¥–∫–∏ –∑ —Ç–∞–±–ª–∏—Ü—ñ
2. **–ï—Ç–∞–ø –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è:** –†–æ–∑–±–∏–≤–∞—î —Ä—è–¥–∫–∏ –Ω–∞ –≥—Ä—É–ø–∏ –∑–∞ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ GROUP BY —Å—Ç–æ–≤–ø—Ü—ñ–≤
3. **–ï—Ç–∞–ø –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó:** –ó–∞—Å—Ç–æ—Å–æ–≤—É—î –∞–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–æ –∫–æ–∂–Ω–æ—ó –≥—Ä—É–ø–∏
4. **–ï—Ç–∞–ø —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É:** –ü–æ–≤–µ—Ä—Ç–∞—î –æ–¥–∏–Ω —Ä—è–¥–æ–∫ –Ω–∞ –≥—Ä—É–ø—É

```sql
-- –î–µ—Ç–∞–ª—å–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –∑ –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º–∏
SELECT
    category_id,                    -- –û–±–æ–≤'—è–∑–∫–æ–≤–æ –≤ GROUP BY
    COUNT(*) as product_count,      -- –ê–≥—Ä–µ–≥–∞—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
    AVG(unit_price) as avg_price,   -- –ê–≥—Ä–µ–≥–∞—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
    MIN(unit_price) as min_price,   -- –ê–≥—Ä–µ–≥–∞—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
    MAX(unit_price) as max_price    -- –ê–≥—Ä–µ–≥–∞—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
FROM products
WHERE discontinued = false         -- –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –î–û –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è
GROUP BY category_id               -- –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –∑–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—î—é
HAVING COUNT(*) > 3               -- –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ü–Ü–°–õ–Ø –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è
ORDER BY avg_price DESC;          -- –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
```

**–°—É–≤–æ—Ä–µ –ø—Ä–∞–≤–∏–ª–æ SELECT –∑ GROUP BY:**

–ü—ñ—Å–ª—è GROUP BY —É SELECT –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¢–Ü–õ–¨–ö–ò:
- –°—Ç–æ–≤–ø—Ü—ñ –∑ GROUP BY
- –ê–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó (COUNT, SUM, AVG, MIN, MAX)
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏
- –í–∏—Ä–∞–∑–∏ –∑ –≤–∏—â–µ–∑–∞–∑–Ω–∞—á–µ–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤

**–ß–∞—Å—Ç—ã–µ –ø–æ–º–∏–ª–∫–∏:**

```sql
-- –ü–û–ú–ò–õ–ö–ê! –ù–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ñ—Å—Ç—å
SELECT category_id, product_name, COUNT(*)  -- product_name –Ω–µ –≤ GROUP BY!
FROM products
GROUP BY category_id;

-- –ü–†–ê–í–ò–õ–¨–ù–û: –∞–±–æ –¥–æ–¥–∞—Ç–∏ –≤ GROUP BY
SELECT category_id, product_name, COUNT(*)
FROM products
GROUP BY category_id, product_name;

-- –ê–ë–û –ø—Ä–∏–±—Ä–∞—Ç–∏ –∑ SELECT
SELECT category_id, COUNT(*)
FROM products
GROUP BY category_id;
```

#### HAVING vs WHERE - –∫—Ä–∏—Ç–∏—á–Ω–∞ —Ä—ñ–∑–Ω–∏—Ü—è

```sql
SELECT category_id, AVG(unit_price) as avg_price, COUNT(*) as product_count
FROM products
WHERE unit_price > 100              -- –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —Ä—è–¥–∫—ñ–≤ –î–û –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è
GROUP BY category_id
HAVING COUNT(*) > 5                 -- –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –≥—Ä—É–ø –ü–Ü–°–õ–Ø –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è
   AND AVG(unit_price) > 1000;      -- –ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
```

**–ö–ª—é—á–æ–≤—ñ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ:**
- **WHERE:** –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –î–û GROUP BY, –Ω–µ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
- **HAVING:** –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ü–Ü–°–õ–Ø GROUP BY, –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
- **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:** WHERE —à–≤–∏–¥—à–µ, –æ—Å–∫—ñ–ª—å–∫–∏ –∑–º–µ–Ω—à—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤ –¥–ª—è –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è

### –ü—ñ–¥–∑–∞–ø–∏—Ç–∏ - –∑–∞–ø–∏—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∑–∞–ø–∏—Ç—ñ–≤

–ü—ñ–¥–∑–∞–ø–∏—Ç - —Ü–µ SQL –∑–∞–ø–∏—Ç, –Ω–∞–ø–∏—Å–∞–Ω–∏–π –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —ñ–Ω—à–æ–≥–æ –∑–∞–ø–∏—Ç—É. –Ø–∫ –º–∞—Ç—Ä—å–æ—à–∫–∞, –∞–ª–µ –¥–ª—è –±–∞–∑ –¥–∞–Ω–∏—Ö.

#### –¢–∏–ø–∏ –ø—ñ–¥–∑–∞–ø–∏—Ç—ñ–≤ –∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º

**1. –°–∫–∞–ª—è—Ä–Ω–∏–π –ø—ñ–¥–∑–∞–ø–∏—Ç - –ø–æ–≤–µ—Ä—Ç–∞—î –û–î–ù–ï –∑–Ω–∞—á–µ–Ω–Ω—è**

```sql
-- –¢–æ–≤–∞—Ä–∏ –¥–æ—Ä–æ–∂—á—ñ –∑–∞ —Å–µ—Ä–µ–¥–Ω—é —Ü—ñ–Ω—É
SELECT product_name, unit_price,
       (SELECT AVG(unit_price) FROM products) as avg_price  -- –°–∫–∞–ª—è—Ä–Ω–∏–π –ø—ñ–¥–∑–∞–ø–∏—Ç
FROM products
WHERE unit_price > (SELECT AVG(unit_price) FROM products);   -- –¢—É—Ç —Ç–µ–∂ —Å–∫–∞–ª—è—Ä–Ω–∏–π
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Å–∫–∞–ª—è—Ä–Ω–∏—Ö –ø—ñ–¥–∑–∞–ø–∏—Ç—ñ–≤:**

- –ú—É—Å—è—Ç—å –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ —Ä—ñ–≤–Ω–æ –æ–¥–∏–Ω —Ä—è–¥–æ–∫ —ñ –æ–¥–∏–Ω —Å—Ç–æ–≤–ø–µ—Ü—å
- –Ø–∫—â–æ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å –±—ñ–ª—å—à–µ - –ø–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
- –Ø–∫—â–æ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å 0 —Ä—è–¥–∫—ñ–≤ - —Ä–µ–∑—É–ª—å—Ç–∞—Ç NULL
- –ú–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –≤—Å—é–¥–∏, –¥–µ –æ—á—ñ–∫—É—î—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–Ω—è

**2. –°—Ç–æ–≤–ø—Ü–µ–≤–∏–π –ø—ñ–¥–∑–∞–ø–∏—Ç - –ø–æ–≤–µ—Ä—Ç–∞—î –°–ü–ò–°–û–ö –∑–Ω–∞—á–µ–Ω—å**

```sql
-- –¢–æ–≤–∞—Ä–∏ –∑ –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π
SELECT product_name, unit_price
FROM products
WHERE category_id IN (
    SELECT category_id
    FROM categories
    WHERE active = true
);  -- ‚Üë –°—Ç–æ–≤–ø—Ü–µ–≤–∏–π –ø—ñ–¥–∑–∞–ø–∏—Ç - –ø–æ–≤–µ—Ä—Ç–∞—î —Å–ø–∏—Å–æ–∫ ID

-- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∑ ANY
SELECT product_name, unit_price
FROM products
WHERE category_id = ANY (
    SELECT category_id FROM categories WHERE active = true
);
```

**3. –¢–∞–±–ª–∏—á–Ω–∏–π –ø—ñ–¥–∑–∞–ø–∏—Ç - –ø–æ–≤–µ—Ä—Ç–∞—î –¢–ê–ë–õ–ò–¶–Æ**

```sql
-- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ FROM - –ø—ñ–¥–∑–∞–ø–∏—Ç —è–∫ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è
SELECT category_stats.category_id,
       category_stats.avg_price,
       category_stats.product_count
FROM (
    SELECT category_id,
           AVG(unit_price) as avg_price,
           COUNT(*) as product_count
    FROM products
    GROUP BY category_id
) as category_stats              -- –û–±–æ–≤'—è–∑–∫–æ–≤–∏–π –ø—Å–µ–≤–¥–æ–Ω—ñ–º!
WHERE category_stats.avg_price > 1000;
```

#### –ö–æ—Ä–µ–ª—å–æ–≤–∞–Ω—ñ –ø—ñ–¥–∑–∞–ø–∏—Ç–∏ - —Å–∫–ª–∞–¥–Ω—ñ, –∞–ª–µ –ø–æ—Ç—É–∂–Ω—ñ

–ö–æ—Ä–µ–ª—å–æ–≤–∞–Ω–∏–π –ø—ñ–¥–∑–∞–ø–∏—Ç "–¥–∏–≤–∏—Ç—å—Å—è" –Ω–∞ –¥–∞–Ω—ñ –∑ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç—É —ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞.

```sql
-- –¢–æ–≤–∞—Ä–∏ –¥–æ—Ä–æ–∂—á—ñ –∑–∞ —Å–µ—Ä–µ–¥–Ω—é —Ü—ñ–Ω—É —É –°–í–û–á–ô –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
SELECT p1.product_name, p1.unit_price, p1.category_id,
       (SELECT AVG(p2.unit_price)
        FROM products p2
        WHERE p2.category_id = p1.category_id) as category_avg_price
FROM products p1
WHERE p1.unit_price > (
    SELECT AVG(p2.unit_price)
    FROM products p2
    WHERE p2.category_id = p1.category_id  -- ‚Üê –ö–æ—Ä–µ–ª—è—Ç–∏–≤–Ω–∞ —É–º–æ–≤–∞!
);
```

**–Ø–∫ –ø—Ä–∞—Ü—é—î –∫–æ—Ä–µ–ª—å–æ–≤–∞–Ω–∏–π –ø—ñ–¥–∑–∞–ø–∏—Ç:**

1. –ó–æ–≤–Ω—ñ—à–Ω—ñ–π –∑–∞–ø–∏—Ç —á–∏—Ç–∞—î –ø–µ—Ä—à–∏–π —Ä—è–¥–æ–∫
2. –ü—ñ–¥–∑–∞–ø–∏—Ç –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –∑–Ω–∞—á–µ–Ω—å –∑ —Ü—å–æ–≥–æ —Ä—è–¥–∫–∞
3. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—ñ–¥–∑–∞–ø–∏—Ç—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó/–æ–±—á–∏—Å–ª–µ–Ω–Ω—è
4. –ü—Ä–æ—Ü–µ—Å –ø–æ–≤—Ç–æ—Ä—é—î—Ç—å—Å—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ –∑–∞–ø–∏—Ç—É

**–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:** –ö–æ—Ä–µ–ª—å–æ–≤–∞–Ω—ñ –ø—ñ–¥–∑–∞–ø–∏—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è N —Ä–∞–∑—ñ–≤ (–¥–µ N - –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤ —É –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Ç–∞–±–ª–∏—Ü—ñ).

#### –û–ø–µ—Ä–∞—Ç–æ—Ä–∏ –¥–ª—è –ø—ñ–¥–∑–∞–ø–∏—Ç—ñ–≤

**EXISTS - –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—è**

```sql
-- –ö–ª—ñ—î–Ω—Ç–∏, —è–∫—ñ —Ä–æ–±–∏–ª–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–µ –∑–∞ IN)
SELECT customer_id, contact_name
FROM customers c
WHERE EXISTS (
    SELECT 1                    -- –ù–µ –≤–∞–∂–ª–∏–≤–æ —â–æ SELECT, –≤–∞–∂–ª–∏–≤–æ —á–∏ —î —Ä—è–¥–∫–∏
    FROM orders o
    WHERE o.customer_id = c.customer_id
);

-- –ö–ª—ñ—î–Ω—Ç–∏ –ë–ï–ó –∑–∞–º–æ–≤–ª–µ–Ω—å
SELECT customer_id, contact_name
FROM customers c
WHERE NOT EXISTS (
    SELECT 1
    FROM orders o
    WHERE o.customer_id = c.customer_id
);
```

**IN vs EXISTS - –∫–æ–ª–∏ —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:**

```sql
-- IN –∫—Ä–∞—â–µ –¥–ª—è –Ω–µ–≤–µ–ª–∏–∫–∏—Ö —Å–ø–∏—Å–∫—ñ–≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç
SELECT * FROM products WHERE category_id IN (1, 2, 3);

-- EXISTS –∫—Ä–∞—â–µ –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –ø—ñ–¥–∑–∞–ø–∏—Ç—ñ–≤
SELECT * FROM customers c
WHERE EXISTS (SELECT 1 FROM orders o WHERE o.customer_id = c.customer_id);

-- –û–±–µ—Ä–µ–∂–Ω–æ –∑ NULL –≤ IN!
SELECT * FROM products WHERE category_id IN (1, 2, NULL); -- –ú–æ–∂–µ –¥–∞—Ç–∏ –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

### –í—ñ–∫–æ–Ω–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó - –∞–Ω–∞–ª—ñ—Ç–∏–∫–∞ –±–µ–∑ –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è

–í—ñ–∫–æ–Ω–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–æ–∑–≤–æ–ª—è—é—Ç—å —Ä–æ–±–∏—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ –≤—Å—ñ —Ä—è–¥–∫–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ. –¶–µ —è–∫ GROUP BY, –∞–ª–µ –±–µ–∑ "—Å—Ö–ª–æ–ø—É–≤–∞–Ω–Ω—è" —Ä—è–¥–∫—ñ–≤.

#### –î–µ—Ç–∞–ª—å–Ω–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```sql
function_name([arguments]) OVER (
    [PARTITION BY column1, column2, ...]     -- –†–æ–∑–±–∏—Ç—Ç—è –Ω–∞ –≥—Ä—É–ø–∏ (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)
    [ORDER BY column3 [ASC|DESC], ...]       -- –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –≤ –≥—Ä—É–ø—ñ (—á–∞—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
    [ROWS|RANGE BETWEEN frame_start AND frame_end] -- –í—ñ–∫–Ω–æ —Ä—è–¥–∫—ñ–≤ (—Ä—ñ–¥–∫–æ)
)
```

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ OVER –∫–ª–∞—É–∑—É–ª–∏:**

- **PARTITION BY** - —Ä–æ–∑–±–∏–≤–∞—î –¥–∞–Ω—ñ –Ω–∞ –≥—Ä—É–ø–∏ (—è–∫ GROUP BY, –∞–ª–µ –±–µ–∑ –∑–≥–æ—Ä—Ç—É–≤–∞–Ω–Ω—è)
- **ORDER BY** - –≤–∏–∑–Ω–∞—á–∞—î –ø–æ—Ä—è–¥–æ–∫ —Ä—è–¥–∫—ñ–≤ –¥–ª—è —Ä–∞–Ω–∂—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–º—ñ—â–µ–Ω–Ω—è
- **Frame specification** - –≤–∏–∑–Ω–∞—á–∞—î —è–∫—ñ —Ä—è–¥–∫–∏ –≤–∫–ª—é—á–∞—Ç–∏ –≤ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è

#### –§—É–Ω–∫—Ü—ñ—ó —Ä–∞–Ω–∂—É–≤–∞–Ω–Ω—è –∑ –Ω—é–∞–Ω—Å–∞–º–∏

**ROW_NUMBER() - –∑–∞–≤–∂–¥–∏ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ –Ω–æ–º–µ—Ä–∏**

```sql
-- –ü—Ä–æ–Ω—É–º–µ—Ä—É–≤–∞—Ç–∏ —Ç–æ–≤–∞—Ä–∏ –∑–∞ —Ü—ñ–Ω–æ—é –≤ –∫–æ–∂–Ω—ñ–π –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
SELECT product_name, category_id, unit_price,
       ROW_NUMBER() OVER (
           PARTITION BY category_id
           ORDER BY unit_price DESC, product_name  -- –î–æ–¥–∞—Ç–∫–æ–≤–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –¥–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ
       ) as row_num
FROM products;
```

**RANK() - —Ä–∞–Ω–≥–∏ –∑ –ø—Ä–æ–ø—É—Å–∫–∞–º–∏**

```sql
-- –†–∞–Ω–∂—É–≤–∞–Ω–Ω—è –∑ –ø—Ä–æ–≥–∞–ª–∏–Ω–∞–º–∏ –ø—Ä–∏ –æ–¥–Ω–∞–∫–æ–≤–∏—Ö –∑–Ω–∞—á–µ–Ω–Ω—è—Ö
SELECT product_name, unit_price,
       RANK() OVER (ORDER BY unit_price DESC) as price_rank
FROM products;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 1, 2, 2, 4, 5... (3-—Ç—è –ø–æ–∑–∏—Ü—ñ—è –ø—Ä–æ–ø—É—â–µ–Ω–∞)
```

**DENSE_RANK() - —Ä–∞–Ω–≥–∏ –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫—ñ–≤**

```sql
-- –†–∞–Ω–∂—É–≤–∞–Ω–Ω—è –±–µ–∑ –ø—Ä–æ–≥–∞–ª–∏–Ω
SELECT product_name, unit_price,
       DENSE_RANK() OVER (ORDER BY unit_price DESC) as dense_rank
FROM products;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 1, 2, 2, 3, 4... (–±–µ–∑ –ø—Ä–æ–ø—É—Å–∫—ñ–≤)
```

**–ü—Ä–∞–∫—Ç–∏—á–Ω–µ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π —Ä–∞–Ω–∂—É–≤–∞–Ω–Ω—è:**

```sql
SELECT product_name, unit_price,
       ROW_NUMBER() OVER (ORDER BY unit_price DESC) as row_num,
       RANK() OVER (ORDER BY unit_price DESC) as rank_num,
       DENSE_RANK() OVER (ORDER BY unit_price DESC) as dense_rank
FROM products
ORDER BY unit_price DESC;

-- –î–ª—è —Ü—ñ–Ω: 1000, 800, 800, 600
-- row_num:    1,   2,   3,   4
-- rank_num:   1,   2,   2,   4  ‚Üê –ø—Ä–æ–ø—É—Å–∫ 3
-- dense_rank: 1,   2,   2,   3  ‚Üê –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫—É
```

#### –§—É–Ω–∫—Ü—ñ—ó –∑–º—ñ—â–µ–Ω–Ω—è - –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –º—ñ–∂ —Ä—è–¥–∫–∞–º–∏

**LAG() —Ç–∞ LEAD() - –¥–∏–≤–∏–º–æ—Å—è –Ω–∞–∑–∞–¥ —Ç–∞ –≤–ø–µ—Ä–µ–¥**

```sql
-- –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º–∏ —Ç–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏
SELECT
    order_date,
    freight,
    LAG(freight, 1, 0) OVER (ORDER BY order_date) as prev_freight,
    LEAD(freight, 1, 0) OVER (ORDER BY order_date) as next_freight,
    freight - LAG(freight, 1, 0) OVER (ORDER BY order_date) as freight_change
FROM orders
ORDER BY order_date;
```

**–°–∏–Ω—Ç–∞–∫—Å–∏—Å LAG/LEAD:**

- `LAG(column, offset, default)` - offset —Ä—è–¥–∫—ñ–≤ –Ω–∞–∑–∞–¥
- `LEAD(column, offset, default)` - offset —Ä—è–¥–∫—ñ–≤ –≤–ø–µ—Ä–µ–¥
- `default` - –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫—â–æ –Ω–µ–º–∞—î –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ/–Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Ä—è–¥–∫–∞

**FIRST_VALUE() —Ç–∞ LAST_VALUE() - –º–µ–∂—ñ –≤—ñ–∫–Ω–∞**

```sql
-- –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –ø–µ—Ä—à–∏–º —Ç–∞ –æ—Å—Ç–∞–Ω–Ω—ñ–º –∑–Ω–∞—á–µ–Ω–Ω—è–º —É –≥—Ä—É–ø—ñ
SELECT product_name, category_id, unit_price,
       FIRST_VALUE(unit_price) OVER (
           PARTITION BY category_id
           ORDER BY unit_price DESC
       ) as highest_in_category,
       LAST_VALUE(unit_price) OVER (
           PARTITION BY category_id
           ORDER BY unit_price DESC
           ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
       ) as lowest_in_category
FROM products;
```

#### –ê–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —è–∫ –≤—ñ–∫–æ–Ω–Ω—ñ

```sql
-- –ù–∞–∫–æ–ø–∏—á—É–≤–∞–ª—å–Ω—ñ —Ç–∞ –∫–æ–≤–∑–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è
SELECT
    order_date,
    freight,
    -- –ù–∞–∫–æ–ø–∏—á—É–≤–∞–ª—å–Ω–∞ —Å—É–º–∞ –≤—ñ–¥ –ø–æ—á–∞—Ç–∫—É
    SUM(freight) OVER (ORDER BY order_date) as running_total,
    -- –ö–æ–≤–∑–Ω–µ —Å–µ—Ä–µ–¥–Ω—î –∑–∞ 3 –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
    AVG(freight) OVER (
        ORDER BY order_date
        ROWS BETWEEN 2 PRECEDING AND CURRENT ROW
    ) as moving_avg_3,
    -- –í—ñ–¥—Å–æ—Ç–æ–∫ –≤—ñ–¥ –∑–∞–≥–∞–ª—å–Ω–æ—ó —Å—É–º–∏
    freight * 100.0 / SUM(freight) OVER () as percent_of_total
FROM orders
ORDER BY order_date;
```

#### PARTITION BY vs GROUP BY - –∫—Ä–∏—Ç–∏—á–Ω–∞ —Ä—ñ–∑–Ω–∏—Ü—è

```sql
-- GROUP BY - —Å—Ö–ª–æ–ø—É—î —Ä—è–¥–∫–∏
SELECT category_id, AVG(unit_price) as avg_price
FROM products
GROUP BY category_id;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: –æ–¥–∏–Ω —Ä—è–¥–æ–∫ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é

-- PARTITION BY - –∑–±–µ—Ä—ñ–≥–∞—î –≤—Å—ñ —Ä—è–¥–∫–∏
SELECT product_name, category_id, unit_price,
       AVG(unit_price) OVER (PARTITION BY category_id) as category_avg
FROM products;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: –∫–æ–∂–µ–Ω —Ç–æ–≤–∞—Ä + —Å–µ—Ä–µ–¥–Ω—è —Ü—ñ–Ω–∞ –π–æ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
```

### Common Table Expressions (CTE) - —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –ø—ñ–¥–∑–∞–ø–∏—Ç–∏

CTE –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–º–µ–Ω–æ–≤–∞–Ω–∏–π —Ç–∏–º—á–∞—Å–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç—É—é—á–∏–π –Ω–∞–±—ñ—Ä, —â–æ —ñ—Å–Ω—É—î —Ç—ñ–ª—å–∫–∏ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É.

#### –ó–≤–∏—á–∞–π–Ω—ñ CTE - –¥–ª—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ

```sql
-- –ó–∞–º—ñ—Å—Ç—å –≤–∞–∂–∫–æ—á–∏—Ç–∞–Ω–æ–≥–æ –≤–∫–ª–∞–¥–µ–Ω–æ–≥–æ –ø—ñ–¥–∑–∞–ø–∏—Ç—É
WITH expensive_products AS (
    SELECT product_id, product_name, unit_price, category_id
    FROM products
    WHERE unit_price > 1000
),
category_stats AS (
    SELECT category_id,
           COUNT(*) as expensive_count,
           AVG(unit_price) as avg_expensive_price
    FROM expensive_products
    GROUP BY category_id
)
-- –¢–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ CTE —è–∫ –∑–≤–∏—á–∞–π–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ
SELECT c.category_name, cs.expensive_count, cs.avg_expensive_price
FROM category_stats cs
JOIN categories c ON cs.category_id = c.category_id
WHERE cs.expensive_count > 2;
```

**–ü–µ—Ä–µ–≤–∞–≥–∏ CTE:**

- –ü–æ–∫—Ä–∞—â—É—î —á–∏—Ç–∞–±–µ–ª—å–Ω—ñ—Å—Ç—å —Å–∫–ª–∞–¥–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
- –î–æ–∑–≤–æ–ª—è—î –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—ñ–¥–∑–∞–ø–∏—Ç–∏
- –ú–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ CTE –≤ –æ–¥–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ
- CTE –º–æ–∂–µ –ø–æ—Å–∏–ª–∞—Ç–∏—Å—è –Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ CTE

#### –†–µ–∫—É—Ä—Å–∏–≤–Ω—ñ CTE - –¥–ª—è —ñ—î—Ä–∞—Ä—Ö—ñ—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö

```sql
-- –ó–Ω–∞–π—Ç–∏ –≤—Å—ñ—Ö –ø—ñ–¥–ª–µ–≥–ª–∏—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (–≤–∫–ª—é—á–∞—é—á–∏ –ø—ñ–¥–ª–µ–≥–ª–∏—Ö –ø—ñ–¥–ª–µ–≥–ª–∏—Ö)
WITH RECURSIVE employee_hierarchy AS (
    -- Anchor query (–±–∞–∑–æ–≤–∏–π –≤–∏–ø–∞–¥–æ–∫): –ø–æ—á–∞—Ç–∫–æ–≤—ñ –º–µ–Ω–µ–¥–∂–µ—Ä–∏
    SELECT employee_id, first_name, last_name, reports_to,
           0 as level,  -- –†—ñ–≤–µ–Ω—å —ñ—î—Ä–∞—Ä—Ö—ñ—ó
           first_name || ' ' || last_name as hierarchy_path
    FROM employees
    WHERE reports_to IS NULL  -- –¢–æ–ø-–º–µ–Ω–µ–¥–∂–µ—Ä–∏

    UNION ALL

    -- Recursive query (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π –≤–∏–ø–∞–¥–æ–∫): –∑–Ω–∞—Ö–æ–¥–∏–º–æ –ø—ñ–¥–ª–µ–≥–ª–∏—Ö
    SELECT e.employee_id, e.first_name, e.last_name, e.reports_to,
           eh.level + 1,  -- –ó–±—ñ–ª—å—à—É—î–º–æ —Ä—ñ–≤–µ–Ω—å
           eh.hierarchy_path || ' -> ' || e.first_name || ' ' || e.last_name
    FROM employees e
    INNER JOIN employee_hierarchy eh ON e.reports_to = eh.employee_id
    WHERE eh.level < 10  -- –û–±–º–µ–∂–µ–Ω–Ω—è –≥–ª–∏–±–∏–Ω–∏ (–∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–∏—Ö —Ü–∏–∫–ª—ñ–≤)
)
SELECT employee_id, first_name, last_name, level, hierarchy_path
FROM employee_hierarchy
ORDER BY level, last_name;
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ CTE:**

1. **Anchor query** - –ø–æ—á–∞—Ç–∫–æ–≤–∞ —É–º–æ–≤–∞ (–±–∞–∑–æ–≤–∏–π –≤–∏–ø–∞–¥–æ–∫)
2. **UNION ALL** - –æ–±'—î–¥–Ω–∞–Ω–Ω—è
3. **Recursive query** - —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞, —â–æ –ø–æ—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ —Å–∞–º–µ CTE
4. **–£–º–æ–≤–∞ –∑—É–ø–∏–Ω–∫–∏** - –æ–±–æ–≤'—è–∑–∫–æ–≤–∞ –¥–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–∏—Ö —Ü–∏–∫–ª—ñ–≤

### –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –ø–æ—Ä–∞–¥–∏ –ø–æ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

#### –ü–æ—Ä—è–¥–æ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è SQL –∑–∞–ø–∏—Ç—É

SQL –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –Ω–µ –≤ —Ç–æ–º—É –ø–æ—Ä—è–¥–∫—É, –≤ —è–∫–æ–º—É –Ω–∞–ø–∏—Å–∞–Ω–∏–π. –†–æ–∑—É–º—ñ–Ω–Ω—è —Ü—å–æ–≥–æ –¥–æ–ø–æ–º–∞–≥–∞—î –ø–∏—Å–∞—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à—ñ –∑–∞–ø–∏—Ç–∏:

1. **FROM / JOIN** - —Å–ø–æ—á–∞—Ç–∫—É –±–µ—Ä–µ–º–æ —Ç–∞ –∑'—î–¥–Ω—É—î–º–æ —Ç–∞–±–ª–∏—Ü—ñ
2. **WHERE** - —Ñ—ñ–ª—å—Ç—Ä—É—î–º–æ —Ä—è–¥–∫–∏ (–î–û –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è!)
3. **GROUP BY** - –≥—Ä—É–ø—É—î–º–æ —Ä—è–¥–∫–∏
4. **HAVING** - —Ñ—ñ–ª—å—Ç—Ä—É—î–º–æ –≥—Ä—É–ø–∏ (–ü–Ü–°–õ–Ø –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è!)
5. **SELECT** - –≤–∏–±–∏—Ä–∞—î–º–æ —Ç–∞ –æ–±—á–∏—Å–ª—é—î–º–æ —Å—Ç–æ–≤–ø—Ü—ñ
6. **DISTINCT** - –≤–∏–¥–∞–ª—è—î–º–æ –¥—É–±–ª—ñ–∫–∞—Ç–∏
7. **ORDER BY** - —Å–æ—Ä—Ç—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
8. **LIMIT / OFFSET** - –æ–±–º–µ–∂—É—î–º–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤

#### –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –∑–∞–ø–∏—Ç—ñ–≤

**1. –ï—Ñ–µ–∫—Ç–∏–≤–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è**

```sql
-- –ö—Ä–∞—â–µ: —Ñ—ñ–ª—å—Ç—Ä—É—î–º–æ —Ä–∞–Ω–æ
SELECT c.contact_name, COUNT(o.order_id)
FROM customers c
    LEFT JOIN orders o ON c.customer_id = o.customer_id
                      AND o.order_date >= '2024-01-01'  -- –§—ñ–ª—å—Ç—Ä –≤ JOIN
WHERE c.customer_type = 'company'                       -- –§—ñ–ª—å—Ç—Ä –ø–µ—Ä–µ–¥ JOIN
GROUP BY c.customer_id, c.contact_name;

-- –ì—ñ—Ä—à–µ: —Ñ—ñ–ª—å—Ç—Ä—É—î–º–æ –ø—ñ–∑–Ω–æ
SELECT c.contact_name, COUNT(o.order_id)
FROM customers c
    LEFT JOIN orders o ON c.customer_id = o.customer_id
WHERE c.customer_type = 'company'
    AND (o.order_date >= '2024-01-01' OR o.order_date IS NULL)
GROUP BY c.customer_id, c.contact_name;
```

**2. –ü—Ä–∞–≤–∏–ª—å–Ω–µ —ñ–Ω–¥–µ–∫—Å—É–≤–∞–Ω–Ω—è**

```sql
-- –°—Ç–≤–æ—Ä—é—î–º–æ —ñ–Ω–¥–µ–∫—Å–∏ –¥–ª—è –Ω–∞–π—á–∞—Å—Ç—ñ—à–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
CREATE INDEX idx_orders_customer_date ON orders(customer_id, order_date);
CREATE INDEX idx_products_category_price ON products(category_id, unit_price);
CREATE INDEX idx_customers_type_region ON customers(customer_type, region_id);

-- –°–∫–ª–∞–¥–µ–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏: –ø–æ—Ä—è–¥–æ–∫ —Å—Ç–æ–≤–ø—Ü—ñ–≤ –≤–∞–∂–ª–∏–≤–∏–π!
-- –Ü–Ω–¥–µ–∫—Å (A, B, C) –ø—Ä–∞—Ü—é—î –¥–ª—è: A, (A,B), (A,B,C)
-- –ê–ª–µ –ù–ï –ø—Ä–∞—Ü—é—î –¥–ª—è: B, C, (B,C)
```

**3. –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—ñ–¥–∑–∞–ø–∏—Ç—ñ–≤**

```sql
-- EXISTS –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–µ –∑–∞ IN –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –Ω–∞–±–æ—Ä—ñ–≤
-- –ö—Ä–∞—â–µ:
SELECT customer_id, contact_name
FROM customers c
WHERE EXISTS (
    SELECT 1 FROM orders o
    WHERE o.customer_id = c.customer_id
      AND o.order_date >= '2024-01-01'
);

-- –ù—ñ–∂:
SELECT customer_id, contact_name
FROM customers
WHERE customer_id IN (
    SELECT customer_id FROM orders
    WHERE order_date >= '2024-01-01'
);
```

**4. –ê–Ω–∞–ª—ñ–∑ –ø–ª–∞–Ω—ñ–≤ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è**

```sql
-- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ EXPLAIN –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É
EXPLAIN (ANALYZE, BUFFERS)
SELECT p.product_name, c.category_name, p.unit_price
FROM products p
JOIN categories c ON p.category_id = c.category_id
WHERE p.unit_price > 1000;

-- –®—É–∫–∞–π—Ç–µ –≤ –ø–ª–∞–Ω—ñ:
-- ‚Ä¢ Seq Scan (–ø–æ–≤–Ω–µ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è) - –∑–∞–∑–≤–∏—á–∞–π –ø–æ–≥–∞–Ω–æ
-- ‚Ä¢ Index Scan (–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—É) - –∑–∞–∑–≤–∏—á–∞–π –¥–æ–±—Ä–µ
-- ‚Ä¢ Nested Loop vs Hash Join - –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ä–æ–∑–º—ñ—Ä—É –¥–∞–Ω–∏—Ö
-- ‚Ä¢ –í–∏—Å–æ–∫–∏–π actual time - –ø–æ—Ç—Ä–µ–±—É—î –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó
```

#### –ü–æ—à–∏—Ä–µ–Ω—ñ –ø–æ–º–∏–ª–∫–∏ —Ç–∞ —è–∫ —ó—Ö —É–Ω–∏–∫–∞—Ç–∏

**1. –ü—Ä–æ–±–ª–µ–º–∞ N+1 –∑–∞–ø–∏—Ç—ñ–≤**

```sql
-- –ü–æ–≥–∞–Ω–æ: –æ–¥–∏–Ω –∑–∞–ø–∏—Ç –¥–ª—è —Å–ø–∏—Å–∫—É + N –∑–∞–ø–∏—Ç—ñ–≤ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π
-- (–∑–∞–∑–≤–∏—á–∞–π –≤ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–º—É –∫–æ–¥—ñ)
SELECT customer_id, contact_name FROM customers LIMIT 10;
-- –ü–æ—Ç—ñ–º –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞:
SELECT COUNT(*) FROM orders WHERE customer_id = ?;

-- –î–æ–±—Ä–µ: –æ–¥–∏–Ω –∑–∞–ø–∏—Ç –∑ JOIN
SELECT c.customer_id, c.contact_name, COUNT(o.order_id) as order_count
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.contact_name
LIMIT 10;
```

**2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è DISTINCT**

```sql
-- –ü–æ–≥–∞–Ω–æ: DISTINCT –º–∞—Å–∫—É—î –ø—Ä–æ–±–ª–µ–º—É –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤
SELECT DISTINCT c.contact_name
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
JOIN order_items oi ON o.order_id = oi.order_id;

-- –î–æ–±—Ä–µ: –∑'—è—Å—É–≤–∞—Ç–∏ –ø—Ä–∏—á–∏–Ω—É –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤
SELECT c.contact_name
FROM customers c
WHERE EXISTS (
    SELECT 1 FROM orders o
    WHERE o.customer_id = c.customer_id
);
```

**3. –ù–µ–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≤ WHERE**

```sql
-- –ü–æ–≥–∞–Ω–æ: —Ñ—É–Ω–∫—Ü—ñ—è –≤ WHERE —É–Ω–µ–º–æ–∂–ª–∏–≤–ª—é—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—É
SELECT * FROM orders
WHERE YEAR(order_date) = 2024;

-- –î–æ–±—Ä–µ: –¥—ñ–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω–¥–µ–∫—Å
SELECT * FROM orders
WHERE order_date >= '2024-01-01'
  AND order_date < '2025-01-01';
```

### –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Ä–æ–±–æ—Ç–∏ –∑ NULL –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏

NULL –≤ SQL - —Ü–µ –Ω–µ "–ø—É—Å—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è", –∞ "–Ω–µ–≤—ñ–¥–æ–º–µ –∑–Ω–∞—á–µ–Ω–Ω—è", —â–æ –º–∞—î –æ—Å–æ–±–ª–∏–≤—É –ª–æ–≥—ñ–∫—É.

**–¢—Ä—å–æ—Ö–∑–Ω–∞—á–Ω–∞ –ª–æ–≥—ñ–∫–∞ SQL:**

- TRUE AND NULL = NULL
- FALSE AND NULL = FALSE
- TRUE OR NULL = TRUE
- FALSE OR NULL = NULL

```sql
-- –û–±–µ—Ä–µ–∂–Ω–æ –∑ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è–º–∏ NULL!
SELECT product_name
FROM products
WHERE category_id = NULL;    -- –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û! –ó–∞–≤–∂–¥–∏ 0 —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

SELECT product_name
FROM products
WHERE category_id IS NULL;  -- –ü–†–ê–í–ò–õ–¨–ù–û

-- NULL –≤ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è—Ö
SELECT product_name,
       unit_price * units_in_stock as total_value  -- NULL —è–∫—â–æ –±—É–¥—å-—â–æ NULL
FROM products;

-- –ë–µ–∑–ø–µ—á–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –∑ COALESCE
SELECT product_name,
       COALESCE(unit_price, 0) * COALESCE(units_in_stock, 0) as total_value
FROM products;
```

**NULL —É –∑'—î–¥–Ω–∞–Ω–Ω—è—Ö:**

```sql
-- NULL –Ω–µ –∑'—î–¥–Ω—É—é—Ç—å—Å—è –Ω–∞–≤—ñ—Ç—å –∑ NULL!
SELECT p.product_name, c.category_name
FROM products p
LEFT JOIN categories c ON p.category_id = c.category_id;
-- –¢–æ–≤–∞—Ä–∏ –∑ category_id = NULL –Ω–µ –∑–Ω–∞–π–¥—É—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ
```

### –ú–æ–¥—É–ª—å–Ω—ñ—Å—Ç—å —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è CTE –¥–ª—è –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—ñ:**

```sql
-- –†–æ–∑–±–∏–≤–∞—î–º–æ —Å–∫–ª–∞–¥–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–∞ –ª–æ–≥—ñ—á–Ω—ñ —á–∞—Å—Ç–∏–Ω–∏
WITH monthly_sales AS (
    -- –ö—Ä–æ–∫ 1: –ê–≥—Ä–µ–≥—É—î–º–æ –ø—Ä–æ–¥–∞–∂—ñ –ø–æ –º—ñ—Å—è—Ü—è—Ö
    SELECT
        DATE_TRUNC('month', o.order_date) as month,
        SUM(oi.quantity * oi.unit_price * (1 - oi.discount)) as revenue
    FROM orders o
    JOIN order_items oi ON o.order_id = oi.order_id
    WHERE o.order_status = 'delivered'
    GROUP BY DATE_TRUNC('month', o.order_date)
),
sales_with_growth AS (
    -- –ö—Ä–æ–∫ 2: –î–æ–¥–∞—î–º–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è
    SELECT month, revenue,
           LAG(revenue) OVER (ORDER BY month) as prev_month_revenue,
           revenue - LAG(revenue) OVER (ORDER BY month) as growth_amount,
           ROUND(
               (revenue - LAG(revenue) OVER (ORDER BY month)) * 100.0 /
               LAG(revenue) OVER (ORDER BY month), 2
           ) as growth_percent
    FROM monthly_sales
)
-- –ö—Ä–æ–∫ 3: –§—ñ–Ω–∞–ª—å–Ω–∞ –≤–∏–±—ñ—Ä–∫–∞ –∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é
SELECT month, revenue, growth_amount, growth_percent
FROM sales_with_growth
WHERE growth_percent IS NOT NULL
ORDER BY month;
```

### –î–∏–Ω–∞–º—ñ—á–Ω—ñ —Ç–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω—ñ –∑–∞–ø–∏—Ç–∏

**–®–∞–±–ª–æ–Ω–∏ –¥–ª—è –≥–Ω—É—á–∫–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤:**

```sql
-- –£–º–æ–≤–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –±–µ–∑ –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ SQL
SELECT product_name, unit_price, category_id
FROM products
WHERE (unit_price >= $1 OR $1 IS NULL)        -- –ü–∞—Ä–∞–º–µ—Ç—Ä –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ—ó —Ü—ñ–Ω–∏
  AND (unit_price <= $2 OR $2 IS NULL)        -- –ü–∞—Ä–∞–º–µ—Ç—Ä –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó —Ü—ñ–Ω–∏
  AND (category_id = $3 OR $3 IS NULL)        -- –ü–∞—Ä–∞–º–µ—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
  AND ($4 IS NULL OR
       ($4 = 'expensive' AND unit_price > 1000) OR
       ($4 = 'cheap' AND unit_price <= 1000)   -- –ü–∞—Ä–∞–º–µ—Ç—Ä —Ç–∏–ø—É —Ç–æ–≤–∞—Ä—É
      );
```

## ‚ñ∂Ô∏è –•—ñ–¥ —Ä–æ–±–æ—Ç–∏

1. –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ –Ω–∞–≤—á–∞–ª—å–Ω–æ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —è–∫–∞ –±—É–ª–∞ —Å—Ç–≤–æ—Ä–µ–Ω–∞ –≤ –õ–†1.
2. –ó'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å
    –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–∞–ø–∏—Ç–∏ –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–æ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö:
    1. INNER JOIN - –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä—ñ–≤ –∑ –Ω–∞–∑–≤–∞–º–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π —Ç–∞ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤:
    ```sql
    SELECT p.product_name, c.category_name, s.company_name, p.unit_price
    FROM products p
    INNER JOIN categories c ON p.category_id = c.category_id
    INNER JOIN suppliers s ON p.supplier_id = s.supplier_id
    ORDER BY c.category_name, p.product_name;
    ```
    2. LEFT JOIN - –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤, –≤–∫–ª—é—á–∞—é—á–∏ —Ç–∏—Ö, —Ö—Ç–æ –Ω–µ –º–∞—î –∑–∞–º–æ–≤–ª–µ–Ω—å:
    ```sql
    SELECT c.contact_name, c.customer_type, r.region_name,
          COUNT(o.order_id) as order_count
    FROM customers c
    LEFT JOIN orders o ON c.customer_id = o.customer_id
    LEFT JOIN regions r ON c.region_id = r.region_id
    GROUP BY c.customer_id, c.contact_name, c.customer_type, r.region_name
    ORDER BY order_count DESC;
    ```
    3. –ú–Ω–æ–∂–∏–Ω–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è - –¥–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:
    ```sql
    -- –í–∞—à –∫–æ–¥ —Ç—É—Ç - —Å—Ç–≤–æ—Ä—ñ—Ç—å –∑–∞–ø–∏—Ç –∑ 4-5 —Ç–∞–±–ª–∏—Ü—å
    ```
3. –ê–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
    1. –ü—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–æ–≤–∞—Ä—ñ–≤ —É –∫–æ–∂–Ω—ñ–π –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ç–∞ —Å–µ—Ä–µ–¥–Ω—é —Ü—ñ–Ω—É:
    ```sql
    SELECT c.category_name,
          COUNT(p.product_id) as product_count,
          AVG(p.unit_price) as avg_price,
          MIN(p.unit_price) as min_price,
          MAX(p.unit_price) as max_price
    FROM categories c
    LEFT JOIN products p ON c.category_id = p.category_id
    GROUP BY c.category_id, c.category_name
    ORDER BY product_count DESC;
    ```
    2. –í–∏–∑–Ω–∞—á–∏—Ç–∏ –∑–∞–≥–∞–ª—å–Ω—ñ –ø—Ä–æ–¥–∞–∂—ñ –∑–∞ —Ä–µ–≥—ñ–æ–Ω–∞–º–∏:
    ```sql
    -- –í–∞—à –∫–æ–¥ —Ç—É—Ç - –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ SUM, GROUP BY —Ç–∞ HAVING
    ```
    3. –ó–Ω–∞–π—Ç–∏ –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫—ñ–≤ –∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Ç–æ–≤–∞—Ä—ñ–≤ –±—ñ–ª—å—à–µ 2:
    ```sql
    -- –í–∞—à –∫–æ–¥ —Ç—É—Ç
    ```
4. –ë–∞–∑–æ–≤—ñ –ø—ñ–¥–∑–∞–ø–∏—Ç–∏
    1. –ó–Ω–∞–π—Ç–∏ —Ç–æ–≤–∞—Ä–∏ –∑ —Ü—ñ–Ω–æ—é –≤–∏—â–æ—é –∑–∞ —Å–µ—Ä–µ–¥–Ω—é —Ü—ñ–Ω—É —Ç–æ–≤–∞—Ä—ñ–≤ —É —Å–≤–æ—ó–π –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó:
    ```sql
    SELECT p.product_name, p.unit_price, c.category_name
    FROM products p
    INNER JOIN categories c ON p.category_id = c.category_id
    WHERE p.unit_price > (
        SELECT AVG(p2.unit_price)
        FROM products p2
        WHERE p2.category_id = p.category_id
    )
    ORDER BY c.category_name, p.unit_price DESC;
    ```
    2. –û—Ç—Ä–∏–º–∞—Ç–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤, —è–∫—ñ –º–∞–ª–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —É 2024 —Ä–æ—Ü—ñ:
    ```sql
    -- –í–∞—à –∫–æ–¥ —Ç—É—Ç - –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –ø—ñ–¥–∑–∞–ø–∏—Ç –∑ IN
    ```
    3. –î–æ–¥–∞—Ç–∏ –¥–æ —Å–ø–∏—Å–∫—É —Ç–æ–≤–∞—Ä—ñ–≤ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–¥–∞–∂—ñ–≤:
    ```sql
    -- –í–∞—à –∫–æ–¥ —Ç—É—Ç - –ø—ñ–¥–∑–∞–ø–∏—Ç —É SELECT
    ```
5. –í–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å —Ä—ñ–≤–Ω—è 2
    1. RIGHT JOIN –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –∫–∞—Ç–µ–≥–æ—Ä—ñ–π —Ç–æ–≤–∞—Ä—ñ–≤ —Ç–∞ —ó—Ö –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ:
    ```sql
    SELECT c.category_name,
          COUNT(p.product_id) as products_count,
          COALESCE(AVG(p.unit_price), 0) as avg_price
    FROM products p
    RIGHT JOIN categories c ON p.category_id = c.category_id
    GROUP BY c.category_id, c.category_name
    ORDER BY products_count DESC;
    ```
    2. Self-join –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ —Ç–∞ —ó—Ö –∫–µ—Ä—ñ–≤–Ω–∏–∫—ñ–≤:
    ```sql
    SELECT e1.first_name || ' ' || e1.last_name as employee,
          e1.title as employee_title,
          e2.first_name || ' ' || e2.last_name as manager,
          e2.title as manager_title
    FROM employees e1
    LEFT JOIN employees e2 ON e1.reports_to = e2.employee_id
    ORDER BY e2.last_name, e1.last_name;
    ```
    3. –†–∞–Ω–∂—É–≤–∞—Ç–∏ —Ç–æ–≤–∞—Ä–∏ –∑–∞ —Ü—ñ–Ω–æ—é –≤ –º–µ–∂–∞—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó:
    ```sql
    SELECT p.product_name,
          c.category_name,
          p.unit_price,
          RANK() OVER (PARTITION BY c.category_name ORDER BY p.unit_price DESC) as price_rank,
          DENSE_RANK() OVER (PARTITION BY c.category_name ORDER BY p.unit_price DESC) as price_dense_rank,
          ROW_NUMBER() OVER (PARTITION BY c.category_name ORDER BY p.unit_price DESC) as row_num
    FROM products p
    JOIN categories c ON p.category_id = c.category_id
    ORDER BY c.category_name, p.unit_price DESC;
    ```
    4. –ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º –∑–∞ –¥–∞—Ç–æ—é:
    ```sql
    -- –í–∞—à –∫–æ–¥ —Ç—É—Ç - –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ LAG() —Ç–∞ LEAD()
    ```
6. –í–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å —Ä—ñ–≤–Ω—è 3
    1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –ø—Ä–æ–¥–∞–∂—ñ–≤:
    ```sql
    CREATE MATERIALIZED VIEW mv_monthly_sales AS
    SELECT
        EXTRACT(YEAR FROM o.order_date) as year,
        EXTRACT(MONTH FROM o.order_date) as month,
        c.category_name,
        r.region_name,
        SUM(oi.quantity * oi.unit_price * (1 - oi.discount)) as total_revenue,
        COUNT(DISTINCT o.order_id) as orders_count,
        AVG(oi.quantity * oi.unit_price * (1 - oi.discount)) as avg_order_value
    FROM orders o
    JOIN order_items oi ON o.order_id = oi.order_id
    JOIN products p ON oi.product_id = p.product_id
    JOIN categories c ON p.category_id = c.category_id
    JOIN customers cu ON o.customer_id = cu.customer_id
    LEFT JOIN regions r ON cu.region_id = r.region_id
    WHERE o.order_status = 'delivered'
    GROUP BY year, month, c.category_name, r.region_name;

    -- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—É –¥–ª—è –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è
    CREATE INDEX idx_mv_monthly_sales_date ON mv_monthly_sales(year, month);
    ```
    2. –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π –∑–∞–ø–∏—Ç –¥–ª—è —ñ—î—Ä–∞—Ä—Ö—ñ—ó –∫–µ—Ä—ñ–≤–Ω–∏–∫—ñ–≤:
    ```sql
    WITH RECURSIVE employee_hierarchy AS (
        -- –ë–∞–∑–æ–≤–∏–π –≤–∏–ø–∞–¥–æ–∫: —Ç–æ–ø-–º–µ–Ω–µ–¥–∂–µ—Ä–∏ (–±–µ–∑ –∫–µ—Ä—ñ–≤–Ω–∏–∫–∞)
        SELECT employee_id, first_name, last_name, title, reports_to,
              0 as level,
              CAST(last_name || ' ' || first_name as VARCHAR(1000)) as hierarchy_path
        FROM employees
        WHERE reports_to IS NULL

        UNION ALL

        -- –†–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π –≤–∏–ø–∞–¥–æ–∫: –ø—ñ–¥–ª–µ–≥–ª—ñ
        SELECT e.employee_id, e.first_name, e.last_name, e.title, e.reports_to,
              eh.level + 1,
              CAST(eh.hierarchy_path || ' -> ' || e.last_name || ' ' || e.first_name as VARCHAR(1000))
        FROM employees e
        JOIN employee_hierarchy eh ON e.reports_to = eh.employee_id
    )
    SELECT * FROM employee_hierarchy
    ORDER BY hierarchy_path;
    ```
7. –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
    1. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ EXPLAIN ANALYZE –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –ø–ª–∞–Ω—ñ–≤ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∞—à–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
    2. –í–∏–∑–Ω–∞—á–∏—Ç–∏ –Ω–∞–π–ø–æ–≤—ñ–ª—å–Ω—ñ—à—ñ –∑–∞–ø–∏—Ç–∏ —Ç–∞ –∑–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ —Å–ø–æ—Å–æ–±–∏ —ó—Ö –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó
    3. –°—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–Ω–¥–µ–∫—Å–∏ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
8. –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª `lab02-report.md` –∑–∞ —à–∞–±–ª–æ–Ω–æ–º ([:fontawesome-solid-download: –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —à–∞–±–ª–æ–Ω](assets/lab02-report-template.download){: download="lab02-report.md"}). –î–æ–¥–∞—Ç–∏ –æ–ø–∏—Å –≤–∏–∫–æ–Ω–∞–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ —Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤. –í–∫–ª—é—á–∏—Ç–∏ —Å–∫—Ä—ñ–Ω—à–æ—Ç–∏. –í–∏–∫–æ–Ω–∞—Ç–∏ –æ—Ü—ñ–Ω–∫—É —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É. –ó–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ —Å–ø–æ—Å–æ–±–∏ —ó—Ö –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó.
9. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–≤—ñ—Ç –∑—ñ —Å–∫—Ä—ñ–Ω—à–æ—Ç–∞–º–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –Ω–∞ GitHub.
10. –Ø–∫ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –∑–∞–≤–¥–∞–Ω–Ω—è –≤ LMS Moodle –≤—Å—Ç–∞–≤–∏—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π.
11. –ó–∞—Ö–∏—Å—Ç–∏—Ç–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—É –ø–µ—Ä–µ–¥ –≤–∏–∫–ª–∞–¥–∞—á–µ–º.

## ‚ùì –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è

1. –í —á–æ–º—É —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ INNER JOIN —Ç–∞ LEFT JOIN? –ö–æ–ª–∏ –¥–æ—Ü—ñ–ª—å–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ–∂–µ–Ω –∑ –Ω–∏—Ö –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –Ω–∞–≤—á–∞–ª—å–Ω–æ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö?
2. –ß–æ–º—É –Ω–µ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ WHERE –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –∞–≥—Ä–µ–≥–∞—Ç–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π? –Ø–∫–∞ —Ä–æ–ª—å HAVING –ø—Ä–∏ –∞–Ω–∞–ª—ñ–∑—ñ –ø—Ä–æ–¥–∞–∂—ñ–≤ —Ç–æ–≤–∞—Ä—ñ–≤?
3. –Ø–∫ –ø—Ä–∞—Ü—é—é—Ç—å –∫–æ—Ä–µ–ª—å–æ–≤–∞–Ω—ñ –ø—ñ–¥–∑–∞–ø–∏—Ç–∏ —ñ —á–∏–º –≤–æ–Ω–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è –≤—ñ–¥ –∑–≤–∏—á–∞–π–Ω–∏—Ö? –ù–∞–≤–µ–¥—ñ—Ç—å –ø—Ä–∏–∫–ª–∞–¥ –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—ñ–≤ –∑ —Ü—ñ–Ω–æ—é –≤–∏—â–µ —Å–µ—Ä–µ–¥–Ω—å–æ—ó –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó.
4. –í —è–∫–∏—Ö —Å–∏—Ç—É–∞—Ü—ñ—è—Ö –¥–æ—Ü—ñ–ª—å–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—ñ–∫–æ–Ω–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–∞–º—ñ—Å—Ç—å GROUP BY –ø—Ä–∏ –∞–Ω–∞–ª—ñ–∑—ñ –∑–∞–º–æ–≤–ª–µ–Ω—å –∫–ª—ñ—î–Ω—Ç—ñ–≤?
5. –©–æ —Ç–∞–∫–µ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —ñ —è–∫—ñ –ø–µ—Ä–µ–≤–∞–≥–∏ –≤–æ–Ω–∏ –¥–∞—é—Ç—å –¥–ª—è –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤ –ø–æ –ø—Ä–æ–¥–∞–∂–∞—Ö —É –Ω–∞–≤—á–∞–ª—å–Ω—ñ–π –±–∞–∑—ñ –¥–∞–Ω–∏—Ö?
6. –Ø–∫ –º–æ–∂–Ω–∞ –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏ –∑ –º–Ω–æ–∂–∏–Ω–Ω–∏–º–∏ –∑'—î–¥–Ω–∞–Ω–Ω—è–º–∏ —Ç–∞–±–ª–∏—Ü—å orders, order_items, products, customers –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ?
7. –Ø–∫–∞ —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ RANK() —Ç–∞ DENSE_RANK() –ø—Ä–∏ —Ä–∞–Ω–∂—É–≤–∞–Ω–Ω—ñ —Ç–æ–≤–∞—Ä—ñ–≤ –∑–∞ —Ü—ñ–Ω–æ—é? –ù–∞–≤–µ–¥—ñ—Ç—å –ø—Ä–∏–∫–ª–∞–¥ –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏.

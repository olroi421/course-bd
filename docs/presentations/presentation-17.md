# –ë–µ–∑–ø–µ–∫–∞ —Ç–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è –±–∞–∑ –¥–∞–Ω–∏—Ö

## –ü–ª–∞–Ω –ª–µ–∫—Ü—ñ—ó

1. –ú–æ–¥–µ–ª—ñ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É
2. –ó–∞–≥—Ä–æ–∑–∏ –±–µ–∑–ø–µ—Ü—ñ –±–∞–∑ –¥–∞–Ω–∏—Ö
3. –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ –º–µ—Ç–æ–¥–∏ –∑–∞—Ö–∏—Å—Ç—É
4. –ê—É–¥–∏—Ç —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
5. –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è

## **üîí –û—Å–Ω–æ–≤–Ω—ñ –ø–æ–Ω—è—Ç—Ç—è:**

**–ê–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è** ‚Äî –ø—Ä–æ—Ü–µ—Å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è** ‚Äî –Ω–∞–¥–∞–Ω–Ω—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø—É –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤.

**–ê—É–¥–∏—Ç** ‚Äî —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω–µ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –¥—ñ–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.

**–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è** ‚Äî –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —É –Ω–µ—á–∏—Ç–∞–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É.

## **1. –ú–æ–¥–µ–ª—ñ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É**

## –î–∏—Å–∫—Ä–µ—Ü—ñ–π–Ω–∞ –º–æ–¥–µ–ª—å (DAC)

### üîë **–í–ª–∞—Å–Ω–∏–∫ –≤–∏–∑–Ω–∞—á–∞—î –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É:**

**–ü—Ä–∏–Ω—Ü–∏–ø–∏:**
- –ö–æ–∂–µ–Ω –æ–±'—î–∫—Ç –º–∞—î –≤–ª–∞—Å–Ω–∏–∫–∞
- –í–ª–∞—Å–Ω–∏–∫ –º–æ–∂–µ –Ω–∞–¥–∞–≤–∞—Ç–∏ –ø—Ä–∞–≤–∞
- –ü—Ä–∞–≤–∞ –º–æ–∂—É—Ç—å –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏—Å—è –¥–∞–ª—ñ

```sql
-- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–æ–ª–µ–π
CREATE ROLE app_admin LOGIN PASSWORD 'secure';
CREATE ROLE app_developer LOGIN PASSWORD 'secure';
CREATE ROLE app_readonly LOGIN PASSWORD 'secure';

-- –ù–∞–¥–∞–Ω–Ω—è –ø—Ä–∞–≤
GRANT SELECT, INSERT, UPDATE, DELETE
    ON ALL TABLES IN SCHEMA app_data
    TO app_developer;

GRANT SELECT ON ALL TABLES IN SCHEMA app_data
    TO app_readonly;
```

### ‚úÖ **–ü–µ—Ä–µ–≤–∞–≥–∏:** –ì–Ω—É—á–∫—ñ—Å—Ç—å, –ø—Ä–æ—Å—Ç–æ—Ç–∞
### ‚ùå **–ù–µ–¥–æ–ª—ñ–∫–∏:** –°–∫–ª–∞–¥–Ω–∏–π —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å

## –ú–∞–Ω–¥–∞—Ç–Ω–∞ –º–æ–¥–µ–ª—å (MAC)

### üèõÔ∏è **–¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä—ñ–≤–Ω—ñ–≤ –±–µ–∑–ø–µ–∫–∏:**

```mermaid
graph TB
    A[–†–Ü–í–ù–Ü –ö–õ–ê–°–ò–§–Ü–ö–ê–¶–Ü–á] --> B[4 - –¢–∞—î–º–Ω—ñ<br/>Secret]
    A --> C[3 - –ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ<br/>Confidential]
    A --> D[2 - –í–Ω—É—Ç—Ä—ñ—à–Ω—ñ<br/>Internal]
    A --> E[1 - –ü—É–±–ª—ñ—á–Ω—ñ<br/>Public]

    F[–ö–û–†–ò–°–¢–£–í–ê–ß] --> G[–†—ñ–≤–µ–Ω—å –¥–æ–ø—É—Å–∫—É: 3]
    G -.->|–î–æ—Å—Ç—É–ø| C
    G -.->|–î–æ—Å—Ç—É–ø| D
    G -.->|–î–æ—Å—Ç—É–ø| E
    G -.->|–ó–∞–±–æ—Ä–æ–Ω–∞| B
```

**–ü—Ä–∞–≤–∏–ª–∞:**
- Read-down: –º–æ–∂–Ω–∞ —á–∏—Ç–∞—Ç–∏ —Å–≤—ñ–π —Ä—ñ–≤–µ–Ω—å —Ç–∞ –Ω–∏–∂—á–µ
- Write-up: –º–æ–∂–Ω–∞ –ø–∏—Å–∞—Ç–∏ —Å–≤—ñ–π —Ä—ñ–≤–µ–Ω—å
- No read-up/write-down

### ‚úÖ **–ü–µ—Ä–µ–≤–∞–≥–∏:** –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –±–µ–∑–ø–µ–∫–∞
### ‚ùå **–ù–µ–¥–æ–ª—ñ–∫–∏:** –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è, –º–µ–Ω—à–∞ –≥–Ω—É—á–∫—ñ—Å—Ç—å

## –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è MAC –≤ PostgreSQL

### üîê **Row-level security –¥–ª—è MAC:**

```sql
-- –¢–∞–±–ª–∏—Ü—è –∑ —Ä—ñ–≤–Ω—è–º–∏ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
CREATE TABLE documents (
    document_id SERIAL PRIMARY KEY,
    title VARCHAR(200),
    content TEXT,
    classification_level INTEGER CHECK (
        classification_level BETWEEN 1 AND 4
    )
);

-- –¢–∞–±–ª–∏—Ü—è –¥–æ–ø—É—Å–∫—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
CREATE TABLE user_clearance (
    username VARCHAR(50) PRIMARY KEY,
    clearance_level INTEGER CHECK (
        clearance_level BETWEEN 1 AND 4
    )
);

-- –ü–æ–ª—ñ—Ç–∏–∫–∞ read-down
CREATE POLICY mac_read_down ON documents
FOR SELECT
USING (
    classification_level <= (
        SELECT clearance_level
        FROM user_clearance
        WHERE username = current_user
    )
);
```

## –†–æ–ª—å–æ–≤–∞ –º–æ–¥–µ–ª—å (RBAC)

### üë• **–ü—Ä–∞–≤–∞ –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω—ñ –Ω–∞–≤–∫–æ–ª–æ —Ä–æ–ª–µ–π:**

```mermaid
graph TB
    U1[üë§ john_sales] --> R1[üìã SALES_ROLE]
    U2[üë§ mary_finance] --> R2[üìã FINANCE_ROLE]
    U3[üë§ alice_manager] --> R3[üìã MANAGEMENT_ROLE]

    R1 --> P1[üìä READ sales.customers<br/>WRITE sales.orders]
    R2 --> P2[üìä READ finance.invoices<br/>WRITE finance.payments]
    R3 --> P3[üìä READ ALL<br/>WRITE management]
```

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏:**
- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ
- –†–æ–ª—ñ (—Ñ—É–Ω–∫—Ü—ñ—ó –≤ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó)
- –ü—Ä–∞–≤–∞ (–æ–ø–µ—Ä–∞—Ü—ñ—ó –∑ –æ–±'—î–∫—Ç–∞–º–∏)
- –°–µ—Å—ñ—ó (–∞–∫—Ç–∏–≤–Ω—ñ —Ä–æ–ª—ñ)

## –ü—Ä–∏–∫–ª–∞–¥ RBAC

### üìã **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–æ–ª–µ–π —Ç–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∞–≤:**

```sql
-- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏—Ö —Ä–æ–ª–µ–π
CREATE ROLE sales_role;
CREATE ROLE finance_role;
CREATE ROLE hr_role;

-- –ù–∞–¥–∞–Ω–Ω—è –ø—Ä–∞–≤ —Ä–æ–ª—è–º
GRANT USAGE ON SCHEMA sales TO sales_role;
GRANT SELECT, INSERT, UPDATE ON sales.customers TO sales_role;
GRANT SELECT, INSERT, UPDATE ON sales.orders TO sales_role;

-- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
CREATE ROLE john_sales LOGIN PASSWORD 'password';
CREATE ROLE mary_finance LOGIN PASSWORD 'password';

-- –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ä–æ–ª–µ–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º
GRANT sales_role TO john_sales;
GRANT finance_role TO mary_finance;

-- –î–∏–Ω–∞–º—ñ—á–Ω–µ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ä–æ–ª–µ–π
SET ROLE sales_role;
```

### ‚úÖ **–ü–µ—Ä–µ–≤–∞–≥–∏:** –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è, –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ
### ‚ùå **–ù–µ–¥–æ–ª—ñ–∫–∏:** –ú–æ–∂–ª–∏–≤–∞ –Ω–∞–¥–º—ñ—Ä–Ω—ñ—Å—Ç—å –ø—Ä–∞–≤

## –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –º–æ–¥–µ–ª–µ–π

| –ú–æ–¥–µ–ª—å | –ì–Ω—É—á–∫—ñ—Å—Ç—å | –ë–µ–∑–ø–µ–∫–∞ | –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å | –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è |
|--------|-----------|---------|------------|--------------|
| **DAC** | üü¢ –í–∏—Å–æ–∫–∞ | üü° –°–µ—Ä–µ–¥–Ω—è | üü¢ –ù–∏–∑—å–∫–∞ | –ö–æ–º–µ—Ä—Ü—ñ–π–Ω—ñ –°–£–ë–î |
| **MAC** | üî¥ –ù–∏–∑—å–∫–∞ | üü¢ –í–∏—Å–æ–∫–∞ | üî¥ –í–∏—Å–æ–∫–∞ | –í—ñ–π—Å—å–∫–æ–≤—ñ —Å–∏—Å—Ç–µ–º–∏ |
| **RBAC** | üü° –°–µ—Ä–µ–¥–Ω—è | üü° –°–µ—Ä–µ–¥–Ω—è | üü° –°–µ—Ä–µ–¥–Ω—è | –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**
- –ë—ñ–∑–Ω–µ—Å-–∑–∞—Å—Ç–æ—Å—É–Ω–∫–∏ ‚Üí RBAC
- –£—Ä—è–¥–æ–≤—ñ —Å–∏—Å—Ç–µ–º–∏ ‚Üí MAC
- –ú–∞–ª—ñ –ø—Ä–æ—î–∫—Ç–∏ ‚Üí DAC

## **2. –ó–∞–≥—Ä–æ–∑–∏ –±–µ–∑–ø–µ—Ü—ñ –±–∞–∑ –¥–∞–Ω–∏—Ö**

## SQL —ñ–Ω'—î–∫—Ü—ñ—ó

### üíâ **–û–¥–Ω–∞ –∑ –Ω–∞–π–Ω–µ–±–µ–∑–ø–µ—á–Ω—ñ—à–∏—Ö –∞—Ç–∞–∫:**

**–í—Ä–∞–∑–ª–∏–≤–∏–π –∫–æ–¥:**
```python
# –ù–ï–ë–ï–ó–ü–ï–ß–ù–û!
query = f"SELECT * FROM users WHERE username = '{username}'"
cursor.execute(query)
```

**–ê—Ç–∞–∫–∞:**
```python
username = "admin' --"
# –†–µ–∑—É–ª—å—Ç–∞—Ç: SELECT * FROM users WHERE username = 'admin' --'
# –ß–∞—Å—Ç–∏–Ω–∞ –ø—ñ—Å–ª—è -- –∫–æ–º–µ–Ω—Ç—É—î—Ç—å—Å—è!
```

**–ù–∞—Å–ª—ñ–¥–∫–∏:**
- –ù–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø
- –í–∏—Ç—ñ–∫ –¥–∞–Ω–∏—Ö
- –ó–º—ñ–Ω–∞/–≤–∏–¥–∞–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
- –í–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥ –û–°

## –¢–∏–ø–∏ SQL —ñ–Ω'—î–∫—Ü—ñ–π

### üéØ **–û—Å–Ω–æ–≤–Ω—ñ —Ä—ñ–∑–Ω–æ–≤–∏–¥–∏:**

**Union-based:**
```sql
' UNION SELECT credit_card, cvv, expiry FROM payments --
```

**Boolean-based blind:**
```sql
' AND SUBSTRING(password, 1, 1) = 'a' --
```

**Time-based blind:**
```sql
' AND IF(SUBSTRING(password,1,1)='a', SLEEP(5), 0) --
```

**Second-order:**
- –®–∫—ñ–¥–ª–∏–≤–∏–π –∫–æ–¥ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ –ë–î
- –í–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ø—ñ–∑–Ω—ñ—à–µ –≤ —ñ–Ω—à–æ–º—É –∑–∞–ø–∏—Ç—ñ

## –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ SQL —ñ–Ω'—î–∫—Ü—ñ–π

### üõ°Ô∏è **–ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ –º–µ—Ç–æ–¥–∏ –∑–∞—Ö–∏—Å—Ç—É:**

**1. –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω—ñ –∑–∞–ø–∏—Ç–∏:**
```python
# –ë–ï–ó–ü–ï–ß–ù–û!
query = "SELECT * FROM users WHERE username = %s"
cursor.execute(query, (username,))
```

**2. ORM:**
```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü—ñ—è
user = session.query(User).filter(
    User.username == username
).first()
```

**3. –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–≤–æ–¥—É:**
```python
import re

if not re.match(r'^[a-zA-Z0-9_]+$', username):
    raise ValueError("Invalid username")
```

**4. –û–±–º–µ–∂–µ–Ω–Ω—è –ø—Ä–∞–≤ –≤ –ë–î:**
```sql
GRANT SELECT, INSERT, UPDATE ON users TO app_user;
REVOKE DROP, TRUNCATE ON ALL TABLES FROM app_user;
```

## –ù–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø

### üö™ **–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ –≤—Ö–æ–¥—É:**

**–ú–µ—Ç–æ–¥–∏ –∞—Ç–∞–∫:**
- –ü—ñ–¥–±—ñ—Ä –ø–∞—Ä–æ–ª—ñ–≤ (brute force)
- –§—ñ—à–∏–Ω–≥
- –í–∏–∫—Ä–∞–¥–µ–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ
- Exploitation –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π

**–ó–∞—Ö–∏—Å—Ç:**
- –ë–∞–≥–∞—Ç–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è (2FA)
- –°–∫–ª–∞–¥–Ω—ñ –ø–∞—Ä–æ–ª—ñ
- –û–±–º–µ–∂–µ–Ω–Ω—è —Å–ø—Ä–æ–± –≤—Ö–æ–¥—É
- –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –∞–Ω–æ–º–∞–ª—å–Ω–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

## –ë–∞–≥–∞—Ç–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è

### üîê **–î–æ–¥–∞—Ç–∫–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –∑–∞—Ö–∏—Å—Ç—É:**

```python
import pyotp

# –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞
secret = pyotp.random_base32()

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è TOTP
totp = pyotp.TOTP(secret)

# –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è QR –∫–æ–¥—É –¥–ª—è Google Authenticator
uri = totp.provisioning_uri(
    name='user@example.com',
    issuer_name='MyApp'
)

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ–∫–µ–Ω—É
token = input("Enter 2FA code: ")
if totp.verify(token):
    print("Login successful!")
```

**–¢–∏–ø–∏ —Ñ–∞–∫—Ç–æ—Ä—ñ–≤:**
- –©–æ—Å—å, —â–æ –≤–∏ –∑–Ω–∞—î—Ç–µ (–ø–∞—Ä–æ–ª—å)
- –©–æ—Å—å, —â–æ –≤–∏ –º–∞—î—Ç–µ (—Ç–µ–ª–µ—Ñ–æ–Ω)
- –©–æ—Å—å, —á–∏–º –≤–∏ —î (–±—ñ–æ–º–µ—Ç—Ä—ñ—è)

## Rate Limiting —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è –∞—Ç–∞–∫

### ‚è±Ô∏è **–û–±–º–µ–∂–µ–Ω–Ω—è —Å–ø—Ä–æ–± –≤—Ö–æ–¥—É:**

**–°—Ç—Ä–∞—Ç–µ–≥—ñ—è:**
- –ú–∞–∫—Å–∏–º—É–º 5 —Å–ø—Ä–æ–± –∑–∞ 5 —Ö–≤–∏–ª–∏–Ω
- –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –Ω–∞ 15 —Ö–≤–∏–ª–∏–Ω –ø—Ä–∏ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—ñ
- –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤

**–í–∏—è–≤–ª–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—ñ–π:**
- –ú–Ω–æ–∂–∏–Ω–Ω—ñ –Ω–µ–≤–¥–∞–ª—ñ —Å–ø—Ä–æ–±–∏
- –í—Ö—ñ–¥ –∑ –Ω–µ—Ç–∏–ø–æ–≤–æ—ó –ª–æ–∫–∞—Ü—ñ—ó
- –û–¥–Ω–æ—á–∞—Å–Ω—ñ –≤—Ö–æ–¥–∏ –∑ —Ä—ñ–∑–Ω–∏—Ö –∫—Ä–∞—ó–Ω
- –í—Ö—ñ–¥ —É –Ω–µ–∑–≤–∏—á–Ω–∏–π —á–∞—Å

**–î—ñ—ó:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
- –ó–∞–ø–∏—Ç –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

## **3. –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ –º–µ—Ç–æ–¥–∏ –∑–∞—Ö–∏—Å—Ç—É**

## –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —É —Å–ø–æ–∫–æ—ó

### üíæ **Encryption at Rest:**

**–†—ñ–≤–Ω—ñ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è:**

**–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Å—Ç–æ–≤–ø—Ü—ñ–≤:**
```sql
CREATE EXTENSION pgcrypto;

-- –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —á—É—Ç–ª–∏–≤–∏—Ö –¥–∞–Ω–∏—Ö
INSERT INTO customers (
    email,
    ssn_encrypted,
    credit_card_encrypted
) VALUES (
    'user@example.com',
    pgp_sym_encrypt('123-45-6789', 'key'),
    pgp_sym_encrypt('4532-1234-5678', 'key')
);

-- –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
SELECT
    email,
    pgp_sym_decrypt(ssn_encrypted, 'key') as ssn
FROM customers;
```

**–ü—Ä–æ–∑–æ—Ä–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (TDE):** –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –≤—Å—ñ—î—ó –ë–î –Ω–∞ —Ä—ñ–≤–Ω—ñ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏

## –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á—ñ

### üîê **Encryption in Transit - SSL/TLS:**

**–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è PostgreSQL:**
```conf
# postgresql.conf
ssl = on
ssl_cert_file = 'server.crt'
ssl_key_file = 'server.key'
ssl_ca_file = 'root.crt'
ssl_min_protocol_version = 'TLSv1.2'
```

**–í–∏–º–∞–≥–∞–Ω–Ω—è SSL:**
```conf
# pg_hba.conf
hostssl all all 0.0.0.0/0 md5
hostnossl all all 0.0.0.0/0 reject
```

**–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑ SSL:**
```python
conn = psycopg2.connect(
    host='db.example.com',
    database='production',
    user='app_user',
    password='password',
    sslmode='verify-full',
    sslrootcert='/path/to/root.crt'
)
```

## –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–ª—é—á–∞–º–∏ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è

### üîë **Key Management:**

**–ü—Ä–∏–Ω—Ü–∏–ø–∏:**
- –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤
- –†–µ–≥—É–ª—è—Ä–Ω–∞ —Ä–æ—Ç–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤ (90 –¥–Ω—ñ–≤)
- –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –æ–±–æ–≤'—è–∑–∫—ñ–≤
- –ê—É–¥–∏—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤

**–†—ñ—à–µ–Ω–Ω—è:**
- AWS KMS (Key Management Service)
- Azure Key Vault
- HashiCorp Vault
- Google Cloud KMS

**–†–æ—Ç–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤:**
1. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –Ω–æ–≤–æ–≥–æ –∫–ª—é—á–∞
2. –ü–µ—Ä–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
3. –ê—Ä—Ö—ñ–≤—É–≤–∞–Ω–Ω—è —Å—Ç–∞—Ä–æ–≥–æ –∫–ª—é—á–∞
4. –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó

## **4. –ê—É–¥–∏—Ç —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥**

## –°–∏—Å—Ç–µ–º–∞ –∞—É–¥–∏—Ç—É

### üìä **–ö–æ–º–ø–ª–µ–∫—Å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è:**

```sql
-- –¢–∞–±–ª–∏—Ü—è –∞—É–¥–∏—Ç—É
CREATE TABLE audit_log (
    audit_id BIGSERIAL PRIMARY KEY,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    username VARCHAR(50),
    operation VARCHAR(20),
    table_name VARCHAR(100),
    old_values JSONB,
    new_values JSONB,
    client_ip INET,
    success BOOLEAN
);

-- –¢—Ä–∏–≥–µ—Ä –∞—É–¥–∏—Ç—É
CREATE TRIGGER audit_customers
AFTER INSERT OR UPDATE OR DELETE ON customers
FOR EACH ROW EXECUTE FUNCTION audit_function();
```

**–©–æ –ª–æ–≥—É–≤–∞—Ç–∏:**
- –í—Å—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑–º—ñ–Ω–∏ –¥–∞–Ω–∏—Ö
- –î–æ—Å—Ç—É–ø –¥–æ —á—É—Ç–ª–∏–≤–∏—Ö –¥–∞–Ω–∏—Ö
- –ó–º—ñ–Ω–∏ —Å—Ö–µ–º–∏ –ë–î
- –ó–º—ñ–Ω–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó–≤
- –ù–µ–≤–¥–∞–ª—ñ —Å–ø—Ä–æ–±–∏ –¥–æ—Å—Ç—É–ø—É

## –ê–Ω–∞–ª—ñ–∑ –ª–æ–≥—ñ–≤ –±–µ–∑–ø–µ–∫–∏

### üîç **–í–∏—è–≤–ª–µ–Ω–Ω—è –ø—ñ–¥–æ–∑—Ä—ñ–ª–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ:**

```sql
-- –ú–∞—Å–æ–≤–µ —á–∏—Ç–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
SELECT username, COUNT(*) as operations
FROM audit_log
WHERE timestamp > CURRENT_TIMESTAMP - INTERVAL '1 hour'
  AND operation = 'SELECT'
GROUP BY username
HAVING COUNT(*) > 1000;

-- –î–æ—Å—Ç—É–ø –≤–Ω–æ—á—ñ
SELECT username, COUNT(*) as night_operations
FROM audit_log
WHERE EXTRACT(HOUR FROM timestamp) BETWEEN 0 AND 6
  AND timestamp > CURRENT_TIMESTAMP - INTERVAL '7 days'
GROUP BY username
HAVING COUNT(*) > 10;

-- –ú–∞—Å–æ–≤—ñ –≤–∏–¥–∞–ª–µ–Ω–Ω—è
SELECT username, table_name, COUNT(*) as deletions
FROM audit_log
WHERE operation = 'DELETE'
  AND timestamp > CURRENT_TIMESTAMP - INTERVAL '24 hours'
GROUP BY username, table_name
HAVING COUNT(*) > 100;
```

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

### ‚ö° **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è –∑–∞–≥—Ä–æ–∑:**

**–ê–ª–µ—Ä—Ç–∏:**
- –ú–Ω–æ–∂–∏–Ω–Ω—ñ –Ω–µ–≤–¥–∞–ª—ñ –≤—Ö–æ–¥–∏
- –î–æ—Å—Ç—É–ø –¥–æ –Ω–µ–∑–≤–∏—á–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—å
- –ó–º—ñ–Ω–∏ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- –ü—ñ–¥–æ–∑—Ä—ñ–ª–∞ –∑–º—ñ–Ω–∞ –ø—Ä–∏–≤—ñ–ª–µ—ó–≤

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –¥—ñ—ó:**
- –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É
- –ó–∞–ø–∏—Ç –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤
- –õ–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è

**–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è:**
- SIEM —Å–∏—Å—Ç–µ–º–∏ (Splunk, ELK)
- Alerting (PagerDuty, Slack)
- Ticketing —Å–∏—Å—Ç–µ–º–∏ (Jira)

## **5. –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è**

## –¢–∏–ø–∏ —Ä–µ–∑–µ—Ä–≤–Ω–∏—Ö –∫–æ–ø—ñ–π

### üíæ **–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—è:**

```mermaid
graph TB
    A[–°–¢–†–ê–¢–ï–ì–Ü–Ø –ë–ï–ö–ê–ü–Ü–í] --> B[üì¶ –ü–æ–≤–Ω—ñ<br/>Full Backup]
    A --> C[üìà –Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ñ<br/>Incremental]
    A --> D[üìù WAL –∞—Ä—Ö—ñ–≤–∏<br/>Continuous]

    B --> E[–©–æ–¥–µ–Ω–Ω–æ<br/>2:00 AM]
    C --> F[–ö–æ–∂–Ω—ñ 6 –≥–æ–¥–∏–Ω]
    D --> G[–ë–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω–æ]

    E --> H[–ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è:<br/>30 –¥–Ω—ñ–≤]
    F --> I[–ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è:<br/>7 –¥–Ω—ñ–≤]
    G --> J[–ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è:<br/>7 –¥–Ω—ñ–≤]
```

**–ü—Ä–∞–≤–∏–ª–æ 3-2-1:**
- 3 –∫–æ–ø—ñ—ó –¥–∞–Ω–∏—Ö
- 2 —Ä—ñ–∑–Ω–∏—Ö –Ω–æ—Å—ñ—ó
- 1 –∫–æ–ø—ñ—è –æ—Ñ—Å–∞–π—Ç

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è

### ü§ñ **–°–∫—Ä–∏–ø—Ç –¥–ª—è PostgreSQL:**

```bash
#!/bin/bash

# –ü–æ–≤–Ω–µ —Ä–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="full_backup_$TIMESTAMP.dump"

pg_dump -Fc -f "$BACKUP_FILE" production

# –°—Ç–∏—Å–Ω–µ–Ω–Ω—è
gzip "$BACKUP_FILE"

# –í–∏–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ S3
aws s3 cp "$BACKUP_FILE.gz" \
    "s3://backups/full/$BACKUP_FILE.gz"

# –í–∏–¥–∞–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö –ª–æ–∫–∞–ª—å–Ω–∏—Ö –∫–æ–ø—ñ–π
find /backups -name "*.gz" -mtime +30 -delete
```

**–ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ cron:**
```cron
# –ü–æ–≤–Ω–µ —â–æ–¥–µ–Ω–Ω–æ –æ 2:00
0 2 * * * /usr/local/bin/backup.sh full

# –Ü–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–µ –∫–æ–∂–Ω—ñ 6 –≥–æ–¥–∏–Ω
0 */6 * * * /usr/local/bin/backup.sh incremental
```

## –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ—Å–ª—è –∑–±–æ—ó–≤

### üîß **–ü—Ä–æ—Ü–µ–¥—É—Ä–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è:**

**–ü–æ–≤–Ω–µ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è:**
```bash
# –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±–µ–∫–∞–ø—É –∑ S3
aws s3 cp s3://backups/full/latest.dump.gz .

# –†–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è
gunzip latest.dump.gz

# –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è
pg_restore -d production -Fc latest.dump
```

**Point-in-Time Recovery (PITR):**
```bash
# –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Å—É
restore_command = 'cp /wal_archive/%f %p'
recovery_target_time = '2024-10-05 14:30:00'
recovery_target_action = 'promote'
```

**–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è:** –†–µ–≥—É–ª—è—Ä–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ, —â–æ –±–µ–∫–∞–ø–∏ –º–æ–∂–Ω–∞ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏!

## –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –±–µ–∫–∞–ø—ñ–≤

### üìä **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞–Ω—É:**

```sql
-- –û—Å—Ç–∞–Ω–Ω—ñ —É—Å–ø—ñ—à–Ω—ñ –±–µ–∫–∞–ø–∏
SELECT
    backup_type,
    MAX(backup_time) as last_backup,
    EXTRACT(EPOCH FROM (
        CURRENT_TIMESTAMP - MAX(backup_time)
    ))/3600 as hours_ago
FROM backup_history
GROUP BY backup_type;

-- –†–æ–∑–º—ñ—Ä –±–µ–∫–∞–ø—ñ–≤
SELECT
    backup_type,
    pg_size_pretty(AVG(backup_size)) as avg_size,
    COUNT(*) as count
FROM backup_history
WHERE backup_time > CURRENT_DATE - INTERVAL '30 days'
GROUP BY backup_type;
```

**–ê–ª–µ—Ä—Ç–∏:**
- –ë–µ–∫–∞–ø –Ω–µ –≤–∏–∫–æ–Ω—É–≤–∞–≤—Å—è > 24 –≥–æ–¥–∏–Ω–∏
- –†—ñ–∑–∫–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É –±–µ–∫–∞–ø—É
- –ù–µ–≤–¥–∞–ª–µ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏ —Ç–µ—Å—Ç—ñ

## –í–∏—Å–Ω–æ–≤–∫–∏

### üéØ **–ö–ª—é—á–æ–≤—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏ –±–µ–∑–ø–µ–∫–∏:**

**–ë–∞–≥–∞—Ç–æ—Ä—ñ–≤–Ω–µ–≤–∏–π –∑–∞—Ö–∏—Å—Ç:**
- –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É (RBAC/MAC)
- –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (at rest + in transit)
- –ê—É–¥–∏—Ç —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥
- –†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è

**–ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:**
- –†–µ–≥—É–ª—è—Ä–Ω—ñ –∞—É–¥–∏—Ç–∏ –±–µ–∑–ø–µ–∫–∏
- –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º
- –ù–∞–≤—á–∞–Ω–Ω—è –ø–µ—Ä—Å–æ–Ω–∞–ª—É
- –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ü–µ–¥—É—Ä –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è

**–ö–æ–º–ø–ª–∞—î–Ω—Å:**
- GDPR, HIPAA, PCI DSS
- –î–æ–∫—É–º–µ–Ω—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ü–µ–¥—É—Ä
- –†–µ–≥—É–ª—è—Ä–Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏

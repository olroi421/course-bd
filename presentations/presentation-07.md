# –õ–æ–≥—ñ—á–Ω–µ —Ç–∞ —Ñ—ñ–∑–∏—á–Ω–µ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è

## –ü–ª–∞–Ω –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—ó

1. –ï—Ç–∞–ø–∏ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è –ë–î
2. –õ–æ–≥—ñ—á–Ω–µ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è
3. –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —ñ—î—Ä–∞—Ä—Ö—ñ–π
4. –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó –ø–µ—Ä–≤–∏–Ω–Ω–∏—Ö –∫–ª—é—á—ñ–≤
5. –î–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è
6. –§—ñ–∑–∏—á–Ω–µ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è
7. –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó


## **üìö –û—Å–Ω–æ–≤–Ω—ñ –ø–æ–Ω—è—Ç—Ç—è:**

**–õ–æ–≥—ñ—á–Ω–µ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è** ‚Äî –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ—ó –º–æ–¥–µ–ª—ñ –≤ –º–æ–¥–µ–ª—å –¥–∞–Ω–∏—Ö, –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—é –°–£–ë–î.

**–§—ñ–∑–∏—á–Ω–µ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è** ‚Äî –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å–ø–æ—Å–æ–±—ñ–≤ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –Ω–∞ —Ñ—ñ–∑–∏—á–Ω–∏—Ö –Ω–æ—Å—ñ—è—Ö –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ.

**–î–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è** ‚Äî –Ω–∞–≤–º–∏—Å–Ω–∏–π –≤—ñ–¥—Ö—ñ–¥ –≤—ñ–¥ –Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–ª—è –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ.

**–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è** ‚Äî —Ñ—ñ–∑–∏—á–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è —Ä—è–¥–∫—ñ–≤ —É —Ç–∞–±–ª–∏—Ü—ñ –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –¥–æ—Å—Ç—É–ø—É.

**–Ü–Ω–¥–µ–∫—Å** ‚Äî –¥–æ–ø–æ–º—ñ–∂–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö, —â–æ –ø—Ä–∏—Å–∫–æ—Ä—é—î –ø–æ—à—É–∫ –∑–∞–ø–∏—Å—ñ–≤ —É —Ç–∞–±–ª–∏—Ü—ñ –∑–∞ —Ä–∞—Ö—É–Ω–æ–∫ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω–∏—Ö –ø–æ—Å–∏–ª–∞–Ω—å.

**–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è** ‚Äî –ª–æ–≥—ñ—á–Ω–∞ –æ–¥–∏–Ω–∏—Ü—è —Ä–æ–±–æ—Ç–∏ –∑ –±–∞–∑–æ—é –¥–∞–Ω–∏—Ö, —â–æ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –ø–æ–≤–Ω—ñ—Å—Ç—é –∞–±–æ –Ω–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –≤–∑–∞–≥–∞–ª—ñ (–ø—Ä–∏–Ω—Ü–∏–ø –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—ñ).


## **1. –ï—Ç–∞–ø–∏ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è –ë–î**

```mermaid
graph TD
    A[üìã –ö–û–ù–¶–ï–ü–¢–£–ê–õ–¨–ù–ï<br/>–ü–†–û–ï–ö–¢–£–í–ê–ù–ù–Ø] --> B[üß† –õ–û–ì–Ü–ß–ù–ï<br/>–ü–†–û–ï–ö–¢–£–í–ê–ù–ù–Ø]
    B --> C[üíΩ –§–Ü–ó–ò–ß–ù–ï<br/>–ü–†–û–ï–ö–¢–£–í–ê–ù–ù–Ø]

    A1[ER-–¥—ñ–∞–≥—Ä–∞–º–∏<br/>–°—É—Ç–Ω–æ—Å—Ç—ñ —Ç–∞ –∑–≤'—è–∑–∫–∏] --> A
    B1[–¢–∞–±–ª–∏—Ü—ñ<br/>–ö–ª—é—á—ñ<br/>–û–±–º–µ–∂–µ–Ω–Ω—è] --> B
    C1[–Ü–Ω–¥–µ–∫—Å–∏<br/>–†–æ–∑–ø–æ–¥—ñ–ª<br/>–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è] --> C

    D[üìä –ú–û–ù–Ü–¢–û–†–ò–ù–ì] --> E{–ó–∞–¥–æ–≤–æ–ª—å–Ω—è—î<br/>–≤–∏–º–æ–≥–∏?}
    E -->|–ù—ñ| B
    E -->|–¢–∞–∫| F[‚úÖ –ï–ö–°–ü–õ–£–ê–¢–ê–¶–Ü–Ø]
    C --> D
```

### üéØ **–ú–µ—Ç–∞ –∫–æ–∂–Ω–æ–≥–æ –µ—Ç–∞–ø—É:**

- **–ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∏–π:** –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—Ä–µ–¥–º–µ—Ç–Ω–æ—ó –æ–±–ª–∞—Å—Ç—ñ
- **–õ–æ–≥—ñ—á–Ω–∏–π:** –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ–π –°–£–ë–î
- **–§—ñ–∑–∏—á–Ω–∏–π:** –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ


## **2. –õ–æ–≥—ñ—á–Ω–µ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è**

## –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Å—É—Ç–Ω–æ—Å—Ç–µ–π

### üìã **–û—Å–Ω–æ–≤–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞:**

**1. –°—É—Ç–Ω—ñ—Å—Ç—å ‚Üí –¢–∞–±–ª–∏—Ü—è**
```sql
-- –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∞ —Å—É—Ç–Ω—ñ—Å—Ç—å –°–¢–£–î–ï–ù–¢
-- ‚Üì
CREATE TABLE students (
    student_id INT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE
);
```

**2. –ê—Ç—Ä–∏–±—É—Ç–∏ ‚Üí –°—Ç–æ–≤–ø—Ü—ñ**
**3. –ü–µ—Ä–≤–∏–Ω–Ω–∏–π –∫–ª—é—á ‚Üí PRIMARY KEY**

## –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–≤'—è–∑–∫—ñ–≤

### üîó **–ó–≤'—è–∑–æ–∫ "–æ–¥–∏–Ω-–¥–æ-–±–∞–≥–∞—Ç—å–æ—Ö":**

```mermaid
graph LR
    A[üè¢ –§–ê–ö–£–õ–¨–¢–ï–¢<br/>faculty_id] -->|1:N| B[üë®‚Äçüéì –°–¢–£–î–ï–ù–¢<br/>student_id<br/>faculty_id FK]
```

```sql
CREATE TABLE faculties (
    faculty_id INT PRIMARY KEY,
    faculty_name VARCHAR(100) NOT NULL
);

CREATE TABLE students (
    student_id INT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    faculty_id INT,
    FOREIGN KEY (faculty_id) REFERENCES faculties(faculty_id)
);
```

### üîÑ **–ó–≤'—è–∑–æ–∫ "–±–∞–≥–∞—Ç–æ-–¥–æ-–±–∞–≥–∞—Ç—å–æ—Ö":**

```mermaid
graph LR
    A[üë®‚Äçüéì –°–¢–£–î–ï–ù–¢] -->|N:M| B[üìö –†–ï–Ñ–°–¢–†–ê–¶–Ü–Ø]
    B -->|N:M| C[üìñ –ö–£–†–°]
```

```sql
CREATE TABLE enrollments (
    student_id INT,
    course_id INT,
    enrollment_date DATE,
    grade CHAR(2),
    PRIMARY KEY (student_id, course_id),
    FOREIGN KEY (student_id) REFERENCES students(student_id),
    FOREIGN KEY (course_id) REFERENCES courses(course_id)
);
```


## **3. –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —ñ—î—Ä–∞—Ä—Ö—ñ–π**

## –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó –¥–ª—è —ñ—î—Ä–∞—Ä—Ö—ñ–π —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### üå≥ **–°—Ç—Ä–∞—Ç–µ–≥—ñ—è 1: –¢–∞–±–ª–∏—Ü—è –Ω–∞ —ñ—î—Ä–∞—Ä—Ö—ñ—é**

```mermaid
graph TD
    A[üë§ –û–°–û–ë–ê] --> B[üë®‚Äçüéì –°–¢–£–î–ï–ù–¢]
    A --> C[üë®‚Äçüè´ –í–ò–ö–õ–ê–î–ê–ß]
```

```sql
CREATE TABLE persons (
    person_id INT PRIMARY KEY,
    person_type VARCHAR(20) NOT NULL, -- 'STUDENT' / 'TEACHER'
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,

    -- –ê—Ç—Ä–∏–±—É—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞
    student_number VARCHAR(20),
    enrollment_year INT,

    -- –ê—Ç—Ä–∏–±—É—Ç–∏ –≤–∏–∫–ª–∞–¥–∞—á–∞
    employee_number VARCHAR(20),
    salary DECIMAL(10,2)
);
```

**‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏:** –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∑–∞–ø–∏—Ç—ñ–≤, –≤–∏—Å–æ–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
**‚ùå –ù–µ–¥–æ–ª—ñ–∫–∏:** –ë–∞–≥–∞—Ç–æ NULL-–∑–Ω–∞—á–µ–Ω—å

## –°—Ç—Ä–∞—Ç–µ–≥—ñ—è 2: –¢–∞–±–ª–∏—Ü—è –Ω–∞ –∫–ª–∞—Å

```sql
CREATE TABLE students (
    person_id INT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    student_number VARCHAR(20) NOT NULL
);

CREATE TABLE teachers (
    person_id INT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    employee_number VARCHAR(20) NOT NULL
);
```

**‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏:** –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å NULL, —è—Å–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
**‚ùå –ù–µ–¥–æ–ª—ñ–∫–∏:** –î—É–±–ª—é–≤–∞–Ω–Ω—è, —Å–∫–ª–∞–¥–Ω—ñ –ø–æ–ª—ñ–º–æ—Ä—Ñ–Ω—ñ –∑–∞–ø–∏—Ç–∏

## –°—Ç—Ä–∞—Ç–µ–≥—ñ—è 3: –¢–∞–±–ª–∏—Ü—è –Ω–∞ –ø—ñ–¥–∫–ª–∞—Å

```sql
CREATE TABLE persons (
    person_id INT PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL
);

CREATE TABLE students (
    person_id INT PRIMARY KEY,
    student_number VARCHAR(20) NOT NULL,
    FOREIGN KEY (person_id) REFERENCES persons(person_id)
);

CREATE TABLE teachers (
    person_id INT PRIMARY KEY,
    employee_number VARCHAR(20) NOT NULL,
    FOREIGN KEY (person_id) REFERENCES persons(person_id)
);
```

**‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏:** –ù–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –≥–Ω—É—á–∫—ñ—Å—Ç—å
**‚ùå –ù–µ–¥–æ–ª—ñ–∫–∏:** –ü–æ—Ç—Ä–µ–±–∞ –≤ JOIN-–æ–ø–µ—Ä–∞—Ü—ñ—è—Ö


## **4. –°—Ç—Ä–∞—Ç–µ–≥—ñ—ó –ø–µ—Ä–≤–∏–Ω–Ω–∏—Ö –∫–ª—é—á—ñ–≤**

## –ü—Ä–∏—Ä–æ–¥–Ω—ñ vs –®—Ç—É—á–Ω—ñ –∫–ª—é—á—ñ

### üåø **–ü—Ä–∏—Ä–æ–¥–Ω—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏:**

```sql
-- –ü—Ä–∏—Ä–æ–¥–Ω–∏–π –∫–ª—é—á
CREATE TABLE countries (
    country_code CHAR(3) PRIMARY KEY, -- ISO 3166-1
    country_name VARCHAR(100) NOT NULL
);

CREATE TABLE products (
    product_sku VARCHAR(20) PRIMARY KEY, -- SKU
    product_name VARCHAR(200) NOT NULL,
    price DECIMAL(10,2)
);
```

**‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏:**
- –ú–∞—é—Ç—å –±—ñ–∑–Ω–µ—Å-–∑–Ω–∞—á–µ–Ω–Ω—è
- –ó—Ä–æ–∑—É–º—ñ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º
- –ü—Ä–∏—Ä–æ–¥–Ω—ñ –∑–≤'—è–∑–∫–∏ –º—ñ–∂ —Å–∏—Å—Ç–µ–º–∞–º–∏

**‚ùå –ù–µ–¥–æ–ª—ñ–∫–∏:**
- –ú–æ–∂—É—Ç—å –∑–º—ñ–Ω—é–≤–∞—Ç–∏—Å—è
- –Ü–Ω–æ–¥—ñ –≥—Ä–æ–º—ñ–∑–¥–∫—ñ
- –ü—Ä–æ–±–ª–µ–º–∏ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–æ—Å—Ç—ñ

### üîß **–®—Ç—É—á–Ω—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏:**

```sql
-- –®—Ç—É—á–Ω–∏–π –∫–ª—é—á –∑ –∞–≤—Ç–æ—ñ–Ω–∫—Ä–µ–º–µ–Ω—Ç–æ–º
CREATE TABLE customers (
    customer_id SERIAL PRIMARY KEY,
    customer_code VARCHAR(20) UNIQUE, -- –ø—Ä–∏—Ä–æ–¥–Ω–∏–π –∫–ª—é—á
    company_name VARCHAR(200) NOT NULL
);

-- UUID –∫–ª—é—á—ñ
CREATE TABLE orders (
    order_id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    customer_id INT NOT NULL,
    order_date DATE DEFAULT CURRENT_DATE
);
```

**‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏:**
- –ù—ñ–∫–æ–ª–∏ –Ω–µ –∑–º—ñ–Ω—é—é—Ç—å—Å—è
- –ó–∞–≤–∂–¥–∏ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ
- –ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ –¥–ª—è JOIN-–æ–ø–µ—Ä–∞—Ü—ñ–π
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–æ–≥–æ –≥–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è (UUID)

**‚ùå –ù–µ–¥–æ–ª—ñ–∫–∏:**
- –ù–µ –º–∞—é—Ç—å –±—ñ–∑–Ω–µ—Å-–∑–Ω–∞—á–µ–Ω–Ω—è
- –î–æ–¥–∞—Ç–∫–æ–≤–∞ –ø–∞–º'—è—Ç—å
- –ü–æ—Ç—Ä–µ–±—É—é—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö —ñ–Ω–¥–µ–∫—Å—ñ–≤

## üîÑ **–ì—ñ–±—Ä–∏–¥–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:**

```sql
CREATE TABLE employees (
    employee_id SERIAL PRIMARY KEY,        -- –¥–ª—è —Å–∏—Å—Ç–µ–º–∏
    employee_number VARCHAR(20) UNIQUE,    -- –¥–ª—è –±—ñ–∑–Ω–µ—Å—É
    ssn VARCHAR(11) UNIQUE,                -- —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ñ –≤–∏–º–æ–≥–∏
    first_name VARCHAR(50) NOT NULL
);
```


## **5. –î–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è**

## –ú–æ—Ç–∏–≤–∞—Ü—ñ—è –¥–ª—è –¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó

### ‚ö° **–ü—Ä–æ–±–ª–µ–º–∞ –Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä:**

```sql
-- –°–∫–ª–∞–¥–Ω–∏–π –∑–∞–ø–∏—Ç –∑ –º–Ω–æ–∂–∏–Ω–Ω–∏–º–∏ JOIN
SELECT
    o.order_id,
    c.company_name,     -- JOIN –∑ customers
    p.product_name,     -- JOIN –∑ products
    od.quantity,        -- JOIN –∑ order_details
    od.unit_price
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
JOIN order_details od ON o.order_id = od.order_id
JOIN products p ON od.product_id = p.product_id
WHERE o.order_date >= '2023-01-01';
```

**‚ùå –ü—Ä–æ–±–ª–µ–º–∏:**
- –ü–æ–≤—ñ–ª—å–Ω—ñ JOIN-–æ–ø–µ—Ä–∞—Ü—ñ—ó
- –í–∏—Å–æ–∫–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ CPU
- –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

## –¢–µ—Ö–Ω—ñ–∫–∏ –¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó

### üìä **1. –î—É–±–ª—é–≤–∞–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—ñ–≤:**

```sql
-- –î–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –∑–∞–º–æ–≤–ª–µ–Ω—å
CREATE TABLE orders_denormalized (
    order_id INT PRIMARY KEY,
    customer_id INT,
    customer_name VARCHAR(200),    -- ‚Üê –î—É–±–ª—é–≤–∞–Ω–Ω—è
    customer_city VARCHAR(100),    -- ‚Üê –î—É–±–ª—é–≤–∞–Ω–Ω—è
    order_date DATE,
    total_amount DECIMAL(12,2),

    FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
);
```

### üßÆ **2. –ü–µ—Ä–µ–¥–æ–±—á–∏—Å–ª–µ–Ω—ñ –∞–≥—Ä–µ–≥–∞—Ç–∏:**

```sql
-- –¢–∞–±–ª–∏—Ü—è –∑ –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏
CREATE TABLE customer_summary (
    customer_id INT PRIMARY KEY,
    total_orders INT DEFAULT 0,
    total_amount DECIMAL(15,2) DEFAULT 0,
    last_order_date DATE,
    average_order_value DECIMAL(10,2)
);

-- –¢—Ä–∏–≥–µ—Ä –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–≥—Ä–µ–≥–∞—Ç—ñ–≤
CREATE OR REPLACE FUNCTION update_customer_summary()
RETURNS TRIGGER AS $
BEGIN
    -- –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–±–µ–∑–ø–µ—á—É—î –∞—Ç–æ–º–∞—Ä–Ω—ñ—Å—Ç—å –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
    UPDATE customer_summary
    SET
        total_orders = (SELECT COUNT(*) FROM orders WHERE customer_id = NEW.customer_id),
        total_amount = (SELECT COALESCE(SUM(total_amount), 0) FROM orders WHERE customer_id = NEW.customer_id),
        last_order_date = (SELECT MAX(order_date) FROM orders WHERE customer_id = NEW.customer_id)
    WHERE customer_id = NEW.customer_id;

    RETURN NEW;
END;
$ LANGUAGE plpgsql;

CREATE TRIGGER update_customer_summary_trigger
    AFTER INSERT OR UPDATE OR DELETE ON orders
    FOR EACH ROW EXECUTE FUNCTION update_customer_summary();
```

### üìà **3. –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —ñ—î—Ä–∞—Ä—Ö—ñ–π:**

```sql
-- –ó–∞–º—ñ—Å—Ç—å —ñ—î—Ä–∞—Ä—Ö—ñ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ–π
CREATE TABLE product_categories_flat (
    product_id INT PRIMARY KEY,
    category_level_1 VARCHAR(100), -- –ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞
    category_level_2 VARCHAR(100), -- –°–º–∞—Ä—Ç—Ñ–æ–Ω–∏
    category_level_3 VARCHAR(100), -- iPhone
    product_name VARCHAR(200)
);
```

## ‚ö†Ô∏è **–†–∏–∑–∏–∫–∏ –¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó:**

- **–ü—Ä–æ–±–ª–µ–º–∏ —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ** ‚Äî –¥—É–±–ª—é–≤–∞–Ω–Ω—è –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ –Ω–µ—É–∑–≥–æ–¥–∂–µ–Ω–æ—Å—Ç—ñ
- **–£—Å–∫–ª–∞–¥–Ω–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å** ‚Äî –∑–º—ñ–Ω–∏ –≤ –∫—ñ–ª—å–∫–æ—Ö –º—ñ—Å—Ü—è—Ö
- **–ó–±—ñ–ª—å—à–µ–Ω–Ω—è –æ–±—Å—è–≥—É** ‚Äî –¥—É–±–ª—é–≤–∞–Ω–Ω—è –∑–∞–π–º–∞—î –±—ñ–ª—å—à–µ –º—ñ—Å—Ü—è
- **–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å –ø—ñ–¥—Ç—Ä–∏–º–∫–∏** ‚Äî –≤–∞–∂—á–µ —Ä–æ–∑—É–º—ñ—Ç–∏ —Ç–∞ –º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏


## **6. –§—ñ–∑–∏—á–Ω–µ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è**

## –†–æ–∑–º—ñ—â–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤

### üíΩ **–°—Ç—Ä–∞—Ç–µ–≥—ñ—ó —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è:**

```mermaid
graph TD
    A[üöÄ SSD –®–í–ò–î–ö–Ü] --> B[–ê–∫—Ç–∏–≤–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ<br/>–Ü–Ω–¥–µ–∫—Å–∏<br/>–ñ—É—Ä–Ω–∞–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π]

    C[üíæ HDD –í–ï–õ–ò–ö–Ü] --> D[–ê—Ä—Ö—ñ–≤–Ω—ñ –¥–∞–Ω—ñ<br/>–†–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–ø—ñ—ó<br/>–†—ñ–¥–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ]

    E[‚ö° NVME] --> F[–°–∏—Å—Ç–µ–º–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ<br/>–ú–µ—Ç–∞–¥–∞–Ω—ñ<br/>–¢–∏–º—á–∞—Å–æ–≤—ñ —Ñ–∞–π–ª–∏]
```

```sql
-- –†–æ–∑–º—ñ—â–µ–Ω–Ω—è –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö
CREATE TABLESPACE fast_ssd LOCATION '/fast_ssd/pg_data';
CREATE TABLESPACE archive_hdd LOCATION '/archive_hdd/pg_data';

-- –ê–∫—Ç–∏–≤–Ω—ñ –¥–∞–Ω—ñ –Ω–∞ —à–≤–∏–¥–∫–∏—Ö –¥–∏—Å–∫–∞—Ö
CREATE TABLE current_orders (...) TABLESPACE fast_ssd;

-- –ê—Ä—Ö—ñ–≤–Ω—ñ –¥–∞–Ω—ñ –Ω–∞ –ø–æ–≤—ñ–ª—å–Ω–∏—Ö –¥–∏—Å–∫–∞—Ö
CREATE TABLE archived_orders (...) TABLESPACE archive_hdd;
```

## –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è

### üéØ **–ú–µ—Ç–∞:** –§—ñ–∑–∏—á–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –¥–æ—Å—Ç—É–ø—É

```sql
-- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—É –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—ó
CREATE INDEX idx_orders_date ON orders(order_date);

-- –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—è –∑–∞ –¥–∞—Ç–æ—é
CLUSTER orders USING idx_orders_date;
```

```mermaid
graph LR
    A[üìÖ 2023-01-01<br/>üìÖ 2023-01-02<br/>üìÖ 2023-01-03] --> B[üìä –î—ñ–∞–ø–∞–∑–æ–Ω–Ω–∏–π<br/>–∑–∞–ø–∏—Ç]
    B --> C[‚ö° –®–≤–∏–¥–∫–∏–π<br/>–¥–æ—Å—Ç—É–ø]
```

**‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏:**
- –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ—Å—Ç—ñ –¥–∞–Ω–∏—Ö
- –ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à—ñ –¥—ñ–∞–ø–∞–∑–æ–Ω–Ω—ñ –∑–∞–ø–∏—Ç–∏
- –ö—Ä–∞—â–µ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è

**‚ùå –ù–µ–¥–æ–ª—ñ–∫–∏:**
- –ü–æ–≤—ñ–ª—å–Ω—ñ—à—ñ –≤—Å—Ç–∞–≤–∫–∏
- –ü–æ—Ç—Ä–µ–±–∞ –≤ –ø–µ—Ä–µ–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü—ñ—ó

## –†–æ–∑–ø–æ–¥—ñ–ª (Partitioning)

### üìä **–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª:**

```sql
-- –†–æ–∑–ø–æ–¥—ñ–ª –∑–∞ –¥—ñ–∞–ø–∞–∑–æ–Ω–∞–º–∏ –¥–∞—Ç
CREATE TABLE sales (
    sale_id SERIAL,
    sale_date DATE NOT NULL,
    amount DECIMAL(10,2)
) PARTITION BY RANGE (sale_date);

-- –°–µ–∫—Ü—ñ—ó –∑–∞ –º—ñ—Å—è—Ü—è–º–∏
CREATE TABLE sales_2023_01 PARTITION OF sales
    FOR VALUES FROM ('2023-01-01') TO ('2023-02-01');

CREATE TABLE sales_2023_02 PARTITION OF sales
    FOR VALUES FROM ('2023-02-01') TO ('2023-03-01');
```

```mermaid
graph TD
    A[üìä SALES TABLE] --> B[üìÖ 2023-01<br/>–°—ñ—á–µ–Ω—å]
    A --> C[üìÖ 2023-02<br/>–õ—é—Ç–∏–π]
    A --> D[üìÖ 2023-03<br/>–ë–µ—Ä–µ–∑–µ–Ω—å]

    E[üîç –ó–∞–ø–∏—Ç –∑–∞ —Å—ñ—á–µ–Ω—å] --> B
    F[üóëÔ∏è –í–∏–¥–∞–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö –¥–∞–Ω–∏—Ö] --> B
```

### üîÑ **–†–æ–∑–ø–æ–¥—ñ–ª –∑–∞ —Ö–µ—à–µ–º:**

```sql
-- –†–æ–∑–ø–æ–¥—ñ–ª –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑–∞ —Ö–µ—à–µ–º ID
CREATE TABLE user_activities (...) PARTITION BY HASH (user_id);

CREATE TABLE user_activities_0 PARTITION OF user_activities
    FOR VALUES WITH (modulus 4, remainder 0);
-- ... —ñ–Ω—à—ñ —Å–µ–∫—Ü—ñ—ó
```

**‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏ —Ä–æ–∑–ø–æ–¥—ñ–ª—É:**
- –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤
- –ü—Ä–æ—Å—Ç—ñ—à–µ –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è
- –ü–∞—Ä–∞–ª–µ–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞
- –ï—Ñ–µ–∫—Ç–∏–≤–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö –¥–∞–Ω–∏—Ö

### üîÑ **–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –≤ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö:**

–†–æ–∑–ø–æ–¥—ñ–ª —Ç–∞–±–ª–∏—Ü—å —É—Å–∫–ª–∞–¥–Ω—é—î —Ä–æ–±–æ—Ç—É –∑ **—Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è–º–∏**, –æ—Å–æ–±–ª–∏–≤–æ –∫–æ–ª–∏ –æ–¥–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è —Ç–æ—Ä–∫–∞—î—Ç—å—Å—è –∫—ñ–ª—å–∫–æ—Ö —Å–µ–∫—Ü—ñ–π:

```sql
-- –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –º–æ–∂–µ –æ—Ö–æ–ø–ª—é–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ —Å–µ–∫—Ü—ñ–π
BEGIN;
    INSERT INTO sales VALUES (1, '2023-01-15', 1000.00); -- —Å–µ–∫—Ü—ñ—è sales_2023_01
    INSERT INTO sales VALUES (2, '2023-02-15', 1500.00); -- —Å–µ–∫—Ü—ñ—è sales_2023_02
    UPDATE customer_summary SET total_sales = total_sales + 2500.00;
COMMIT; -- –ê—Ç–æ–º–∞—Ä–Ω—ñ—Å—Ç—å –∑–∞–±–µ–∑–ø–µ—á—É—î—Ç—å—Å—è –¥–ª—è –≤—Å—ñ—Ö —Å–µ–∫—Ü—ñ–π
```

## –Ü–Ω–¥–µ–∫—Å–Ω—ñ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó

### üìö **–©–æ —Ç–∞–∫–µ —ñ–Ω–¥–µ–∫—Å?**

**–Ü–Ω–¥–µ–∫—Å** ‚Äî —Ü–µ –¥–æ–ø–æ–º—ñ–∂–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö, —è–∫–∞ —Å—Ç–≤–æ—Ä—é—î –≤–ø–æ—Ä—è–¥–∫–æ–≤–∞–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ä—è–¥–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ—ó —Ç–∞–±–ª–∏—Ü—ñ –¥–ª—è –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è –ø–æ—à—É–∫—É.

```mermaid
graph LR
    A[üîç –ó–ê–ü–ò–¢<br/>WHERE email = 'ivan@email.com'] --> B{–Ñ —ñ–Ω–¥–µ–∫—Å?}
    B -->|–¢–∞–∫| C[üìñ –Ü–Ω–¥–µ–∫—Å –Ω–∞ email<br/>‚Üì<br/>‚ö° –®–≤–∏–¥–∫–∏–π –ø–æ—à—É–∫]
    B -->|–ù—ñ| D[üìã –ü–æ–≤–Ω–µ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è<br/>—Ç–∞–±–ª–∏—Ü—ñ<br/>üêå –ü–æ–≤—ñ–ª—å–Ω–æ]

    C --> E[‚úÖ –ó–Ω–∞–π–¥–µ–Ω–æ –∑–∞ 1-2 –æ–ø–µ—Ä–∞—Ü—ñ—ó]
    D --> F[‚ùå –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –≤—Å—ñ –∑–∞–ø–∏—Å–∏]
```

### üéØ **–¢–∏–ø–∏ —ñ–Ω–¥–µ–∫—Å—ñ–≤:**

```sql
-- B-tree (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º) - –¥–ª—è –∑–∞–≥–∞–ª—å–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
CREATE INDEX idx_customers_email ON customers(email);

-- –°–∫–ª–∞–¥–µ–Ω–∏–π —ñ–Ω–¥–µ–∫—Å - –¥–ª—è –º–Ω–æ–∂–∏–Ω–Ω–∏—Ö —É–º–æ–≤
CREATE INDEX idx_orders_customer_date ON orders(customer_id, order_date);

-- –ß–∞—Å—Ç–∫–æ–≤–∏–π —ñ–Ω–¥–µ–∫—Å - –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö
CREATE INDEX idx_active_customers ON customers(customer_id)
WHERE status = 'ACTIVE';

-- Hash —ñ–Ω–¥–µ–∫—Å - –¥–ª—è —Ç–æ—á–Ω–∏—Ö –ø–æ—à—É–∫—ñ–≤
CREATE INDEX idx_products_sku ON products USING HASH(product_sku);

-- GIN —ñ–Ω–¥–µ–∫—Å - –¥–ª—è JSON –¥–∞–Ω–∏—Ö
CREATE INDEX idx_product_attrs ON products USING GIN(attributes);
```

### üìà **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—ñ–≤:**

```sql
-- –ê–Ω–∞–ª—ñ–∑ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —ñ–Ω–¥–µ–∫—Å—ñ–≤
SELECT
    schemaname,
    tablename,
    indexname,
    idx_scan,           -- –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–∫–∞–Ω—É–≤–∞–Ω—å —ñ–Ω–¥–µ–∫—Å—É
    idx_tup_read,       -- –ø—Ä–æ—á–∏—Ç–∞–Ω–æ –∫–æ—Ä—Ç–µ–∂—ñ–≤ —á–µ—Ä–µ–∑ —ñ–Ω–¥–µ–∫—Å
    idx_tup_fetch       -- –æ—Ç—Ä–∏–º–∞–Ω–æ –∫–æ—Ä—Ç–µ–∂—ñ–≤ –∑ —Ç–∞–±–ª–∏—Ü—ñ
FROM pg_stat_user_indexes
ORDER BY idx_scan DESC;

-- –ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –Ω–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏—Ö —ñ–Ω–¥–µ–∫—Å—ñ–≤
SELECT
    schemaname,
    tablename,
    indexname,
    pg_size_pretty(pg_relation_size(indexname::regclass)) as index_size
FROM pg_stat_user_indexes
WHERE idx_scan = 0  -- —ñ–Ω–¥–µ–∫—Å –Ω—ñ–∫–æ–ª–∏ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è
ORDER BY pg_relation_size(indexname::regclass) DESC;
```

### ‚ö° **–Ü–Ω–¥–µ–∫—Å–∏ —Ç–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:**

- **üìà –ü—Ä–∏—Å–∫–æ—Ä—é—é—Ç—å** SELECT, WHERE, ORDER BY, JOIN
- **üìâ –°–ø–æ–≤—ñ–ª—å–Ω—é—é—Ç—å** INSERT, UPDATE, DELETE
- **üíæ –ó–∞–π–º–∞—é—Ç—å** –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –¥–∏—Å–∫–æ–≤–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä
- **üîÑ –ü–æ—Ç—Ä–µ–±—É—é—Ç—å** –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω–∞—Ö –¥–∞–Ω–∏—Ö


## **7. –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**

## –ï—Ç–∞–ø–Ω—ñ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è

### üîÑ **–Ü—Ç–µ—Ä–∞—Ç–∏–≤–Ω–∏–π –ø—Ä–æ—Ü–µ—Å:**

```mermaid
graph TD
    A[üìã 1. –ù–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∞<br/>—Å—Ç—Ä—É–∫—Ç—É—Ä–∞] --> B[üîç 2. –Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è<br/>–∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤]
    B --> C[üìä 3. –í–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è<br/>–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ]
    C --> D[‚ö° 4. –ü–æ—Å—Ç—É–ø–æ–≤–∞<br/>–æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è]
    D --> E[üìà 5. –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥<br/>–≤ –ø—Ä–æ–¥—É–∫—Ü—ñ—ó]
    E --> F{–ó–∞–¥–æ–≤–æ–ª—å–Ω—è—î<br/>–≤–∏–º–æ–≥–∏?}
    F -->|–ù—ñ| B
    F -->|–¢–∞–∫| G[‚úÖ –°—Ç–∞–±—ñ–ª—å–Ω–∞<br/>—Ä–æ–±–æ—Ç–∞]
```

### üìè **–ü—Ä–∞–≤–∏–ª–æ 80/20:**
- **80% –∑–∞–ø–∏—Ç—ñ–≤** —Å—Ç–æ—Å—É—é—Ç—å—Å—è **20% –¥–∞–Ω–∏—Ö**
- –û–ø—Ç–∏–º—ñ–∑—É–π—Ç–µ –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

## –¢–∏–ø–æ–≤—ñ –ø–æ–º–∏–ª–∫–∏

### ‚ùå **1. –ü–µ—Ä–µ–¥—á–∞—Å–Ω–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è:**

```sql
-- –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: —ñ–Ω–¥–µ–∫—Å–∏ "–Ω–∞ –≤—Å—è–∫–∏–π –≤–∏–ø–∞–¥–æ–∫"
CREATE INDEX idx_users_first_name ON users(first_name);
CREATE INDEX idx_users_last_name ON users(last_name);
CREATE INDEX idx_users_phone ON users(phone);
```

```sql
-- –ü–†–ê–í–ò–õ–¨–ù–û: –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ–∞–ª—å–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
SELECT query, calls, total_time
FROM pg_stat_statements
ORDER BY total_time DESC;

-- –ü–æ—Ç—ñ–º —Å—Ç–≤–æ—Ä—é—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏
CREATE INDEX idx_users_email ON users(email);        -- –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
CREATE INDEX idx_users_status ON users(status, created_at); -- –∞–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å
```

### ‚ùå **2. –Ü–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—è –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ:**

**–ö–∞—Ä–¥–∏–Ω–∞–ª—å–Ω—ñ—Å—Ç—å** ‚Äî –∫—ñ–ª—å–∫—ñ—Å—Ç—å —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å —É —Å—Ç–æ–≤–ø—Ü—ñ. –Ü–Ω–¥–µ–∫—Å–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ —Ç—ñ–ª—å–∫–∏ –¥–ª—è —Å—Ç–æ–≤–ø—Ü—ñ–≤ –∑ –≤–∏—Å–æ–∫–æ—é –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω—ñ—Å—Ç—é.

```sql
-- –ù–ï–ï–§–ï–ö–¢–ò–í–ù–û: –Ω–∏–∑—å–∫–∞ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω—ñ—Å—Ç—å (5-10 —Å—Ç–∞—Ç—É—Å—ñ–≤ –Ω–∞ –º—ñ–ª—å–π–æ–Ω–∏ –∑–∞–ø–∏—Å—ñ–≤)
CREATE INDEX idx_orders_status ON orders(status);

-- –ö–†–ê–©–ï: —á–∞—Å—Ç–∫–æ–≤—ñ —ñ–Ω–¥–µ–∫—Å–∏ –¥–ª—è —Ä—ñ–¥–∫—ñ—Å–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
CREATE INDEX idx_pending_orders ON orders(order_date)
WHERE status = 'PENDING';  -- —Ç—ñ–ª—å–∫–∏ 2-5% –∑–∞–ø–∏—Å—ñ–≤

-- –ê–ë–û: —Å–∫–ª–∞–¥–µ–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏ –∑ –≤–∏—Å–æ–∫–æ—é —Å–µ–ª–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é
CREATE INDEX idx_status_customer ON orders(status, customer_id, order_date);
```

**üîç –ü—Ä–∞–≤–∏–ª–æ:** –Ü–Ω–¥–µ–∫—Å –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π, –∫–æ–ª–∏ –ø–æ–≤–µ—Ä—Ç–∞—î **–º–µ–Ω—à–µ 5-10%** –∑–∞–ø–∏—Å—ñ–≤ —Ç–∞–±–ª–∏—Ü—ñ.

### ‚ùå **3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è:**

```sql
-- –ü–†–û–ë–õ–ï–ú–ê–¢–ò–ß–ù–û: –¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è –±–µ–∑ —Ä–æ–∑—É–º—ñ–Ω–Ω—è
CREATE TABLE orders_bad (
    order_id INT,
    customer_name VARCHAR(200),  -- –¥—É–±–ª—é–≤–∞–Ω–Ω—è
    product_name VARCHAR(200)    -- –ø—Ä–æ–±–ª–µ–º–∞ –¥–ª—è –±–∞–≥–∞—Ç—å–æ—Ö —Ç–æ–≤–∞—Ä—ñ–≤
);

-- –ü–†–ê–í–ò–õ–¨–ù–û: –¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è —Å—Ç–∞–±—ñ–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö
CREATE TABLE orders_good (
    order_id INT,
    customer_id INT,
    customer_name_snapshot VARCHAR(200), -- –∑–Ω—ñ–º–æ–∫ –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
    order_date DATE
);
```

## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### üîß **–ö–æ—Ä–∏—Å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏:**

- **pgAdmin / MySQL Workbench** ‚Äî –≤—ñ–∑—É–∞–ª—å–Ω–µ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è
- **pg_stat_statements** ‚Äî –∞–Ω–∞–ª—ñ–∑ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∑–∞–ø–∏—Ç—ñ–≤
- **EXPLAIN ANALYZE** ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –ø–ª–∞–Ω—ñ–≤ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
- **Flyway / Liquibase** ‚Äî –º—ñ–≥—Ä–∞—Ü—ñ—ó —Å—Ö–µ–º –ë–î

### üìä **–ö–ª—é—á–æ–≤—ñ –º–µ—Ç—Ä–∏–∫–∏:**

```sql
-- –ü–æ–≤—ñ–ª—å–Ω—ñ –∑–∞–ø–∏—Ç–∏ (–ø–æ—Ç—Ä–µ–±—É—é—Ç—å —ñ–Ω–¥–µ–∫—Å—ñ–≤)
SELECT
    query,
    total_time,   -- –∑–∞–≥–∞–ª—å–Ω–∏–π —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
    calls,        -- –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∏–∫–ª–∏–∫—ñ–≤
    mean_time     -- —Å–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
FROM pg_stat_statements
WHERE mean_time > 100 -- –±—ñ–ª—å—à–µ 100ms
ORDER BY total_time DESC;

-- –ù–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏ (–º–æ–∂–Ω–∞ –≤–∏–¥–∞–ª–∏—Ç–∏)
SELECT
    schemaname,
    tablename,
    indexname,
    idx_scan,     -- –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—å
    pg_size_pretty(pg_relation_size(indexname::regclass)) as size
FROM pg_stat_user_indexes
WHERE idx_scan = 0 -- –Ω—ñ–∫–æ–ª–∏ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è
ORDER BY pg_relation_size(indexname::regclass) DESC;

-- –ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
SELECT
    datname,
    xact_commit,    -- —É—Å–ø—ñ—à–Ω—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
    xact_rollback,  -- –≤—ñ–¥–∫–∞—á–µ–Ω—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
    ROUND(100.0 * xact_rollback / (xact_commit + xact_rollback), 2) as rollback_ratio
FROM pg_stat_database
WHERE datname = current_database();
```

## –ó–∞–≥–∞–ª—å–Ω—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏

### ‚úÖ **Do's (–†–æ–±—ñ—Ç—å):**

- **üìä –í–∏–º—ñ—Ä—é–π—Ç–µ** –ø–µ—Ä–µ–¥ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—î—é
- **üìù –î–æ–∫—É–º–µ–Ω—Ç—É–π—Ç–µ** –ø—Ä–æ–µ–∫—Ç–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è
- **üîÑ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ** —Å–∏—Å—Ç–µ–º–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é –≤–µ—Ä—Å—ñ–π –¥–ª—è —Å—Ö–µ–º
- **üìà –ú–æ–Ω—ñ—Ç–æ—Ä—å—Ç–µ** –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø–æ—Å—Ç—ñ–π–Ω–æ
- **üß™ –¢–µ—Å—Ç—É–π—Ç–µ** –Ω–∞ —Ä–µ–∞–ª—å–Ω–∏—Ö –æ–±—Å—è–≥–∞—Ö –¥–∞–Ω–∏—Ö

### ‚ùå **Don'ts (–ù–µ —Ä–æ–±—ñ—Ç—å):**

- **üö´ –ù–µ –æ–ø—Ç–∏–º—ñ–∑—É–π—Ç–µ** –±–µ–∑ –≤–∏–º—ñ—Ä—é–≤–∞–Ω—å
- **üö´ –ù–µ —Å—Ç–≤–æ—Ä—é–π—Ç–µ** –∑–∞–π–≤—ñ —ñ–Ω–¥–µ–∫—Å–∏
- **üö´ –ù–µ –¥–µ–Ω–æ—Ä–º–∞–ª—ñ–∑—É–π—Ç–µ** –±–µ–∑ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ
- **üö´ –ù–µ —ñ–≥–Ω–æ—Ä—É–π—Ç–µ** –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö
- **üö´ –ù–µ –∑–∞–±—É–≤–∞–π—Ç–µ** –ø—Ä–æ –ø—ñ–¥—Ç—Ä–∏–º–∫—É —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ


## **–í–∏—Å–Ω–æ–≤–∫–∏**

### üéØ **–ö–ª—é—á–æ–≤—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏:**

1. **–°–∏—Å—Ç–µ–º–∞—Ç–∏—á–Ω—ñ—Å—Ç—å** ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —á—ñ—Ç–∫—ñ –ø—Ä–∞–≤–∏–ª–∞ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
2. **–ó–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω—ñ—Å—Ç—å** ‚Äî –≤—Ä–∞—Ö—É–π—Ç–µ –ø–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –Ω–µ–¥–æ–ª—ñ–∫–∏ –∫–æ–∂–Ω–æ–≥–æ —Ä—ñ—à–µ–Ω–Ω—è
3. **–Ü—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å** ‚Äî –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è —î –ø—Ä–æ—Ü–µ—Å–æ–º –ø–æ—Å—Ç—ñ–π–Ω–æ–≥–æ –≤–¥–æ—Å–∫–æ–Ω–∞–ª–µ–Ω–Ω—è
4. **–í–∏–º—ñ—Ä—é–≤–∞–Ω—ñ—Å—Ç—å** ‚Äî –±–∞–∑—É–π—Ç–µ —Ä—ñ—à–µ–Ω–Ω—è –Ω–∞ —Ä–µ–∞–ª—å–Ω–∏—Ö –º–µ—Ç—Ä–∏–∫–∞—Ö

### üöÄ **–ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:**

```mermaid
graph LR
    A[üèÅ –ü–û–ß–ù–Ü–¢–¨] --> B[üìã –ù–æ—Ä–º–∞–ª—ñ–∑–æ–≤–∞–Ω–∞<br/>—Å—Ö–µ–º–∞]
    B --> C[üìä –†–µ–∞–ª—å–Ω—ñ<br/>–¥–∞–Ω—ñ]
    C --> D[üîç –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥]
    D --> E[‚ö° –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è]
    E --> F[‚úÖ –£–°–ü–Ü–•]
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–µ –ø—Ä–æ–µ–∫—Ç—É–≤–∞–Ω–Ω—è** —Å—Ç–≤–æ—Ä—é—î –æ—Å–Ω–æ–≤—É –¥–ª—è **–µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—Ö**, **–º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∏—Ö** —Ç–∞ **–ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–∏—Ö** —Å–∏—Å—Ç–µ–º —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –¥–∞–Ω–∏–º–∏! üéâ
